
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>API Reference - HCLIM Utilities</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="HCLIM Utilities" class="md-header__button md-logo" aria-label="HCLIM Utilities" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            HCLIM Utilities
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="HCLIM Utilities" class="md-nav__button md-logo" aria-label="HCLIM Utilities" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    HCLIM Utilities
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HCLIM Utilities
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#master" class="md-nav__link">
    <span class="md-ellipsis">
      master
    </span>
  </a>
  
    <nav class="md-nav" aria-label="master">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#master.load_grib_files" class="md-nav__link">
    <span class="md-ellipsis">
      load_grib_files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.load_hclim_netcdf" class="md-nav__link">
    <span class="md-ellipsis">
      load_hclim_netcdf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.calculate_rainfall_accumulation" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_rainfall_accumulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.create_rectilinear_cube" class="md-nav__link">
    <span class="md-ellipsis">
      create_rectilinear_cube
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.regrid_cube" class="md-nav__link">
    <span class="md-ellipsis">
      regrid_cube
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.extract_common_period" class="md-nav__link">
    <span class="md-ellipsis">
      extract_common_period
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.add_statistical_information" class="md-nav__link">
    <span class="md-ellipsis">
      add_statistical_information
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.plot_dist" class="md-nav__link">
    <span class="md-ellipsis">
      plot_dist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.plot_series" class="md-nav__link">
    <span class="md-ellipsis">
      plot_series
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.plot_diurnal_cycle" class="md-nav__link">
    <span class="md-ellipsis">
      plot_diurnal_cycle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.find_nearest_grid_point" class="md-nav__link">
    <span class="md-ellipsis">
      find_nearest_grid_point
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.plot_location_series" class="md-nav__link">
    <span class="md-ellipsis">
      plot_location_series
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.rainfall_cmap" class="md-nav__link">
    <span class="md-ellipsis">
      rainfall_cmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.prate_1hr_cmap" class="md-nav__link">
    <span class="md-ellipsis">
      prate_1hr_cmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.create_param_plot" class="md-nav__link">
    <span class="md-ellipsis">
      create_param_plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.create_bias_plot" class="md-nav__link">
    <span class="md-ellipsis">
      create_bias_plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.create_param_ani" class="md-nav__link">
    <span class="md-ellipsis">
      create_param_ani
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.create_bias_ani" class="md-nav__link">
    <span class="md-ellipsis">
      create_bias_ani
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.calculate_crude_track" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_crude_track
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.plot_extratropical_cyclone_track" class="md-nav__link">
    <span class="md-ellipsis">
      plot_extratropical_cyclone_track
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.create_weather_map_ani" class="md-nav__link">
    <span class="md-ellipsis">
      create_weather_map_ani
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#master" class="md-nav__link">
    <span class="md-ellipsis">
      master
    </span>
  </a>
  
    <nav class="md-nav" aria-label="master">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#master.load_grib_files" class="md-nav__link">
    <span class="md-ellipsis">
      load_grib_files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.load_hclim_netcdf" class="md-nav__link">
    <span class="md-ellipsis">
      load_hclim_netcdf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.calculate_rainfall_accumulation" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_rainfall_accumulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.create_rectilinear_cube" class="md-nav__link">
    <span class="md-ellipsis">
      create_rectilinear_cube
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.regrid_cube" class="md-nav__link">
    <span class="md-ellipsis">
      regrid_cube
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.extract_common_period" class="md-nav__link">
    <span class="md-ellipsis">
      extract_common_period
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.add_statistical_information" class="md-nav__link">
    <span class="md-ellipsis">
      add_statistical_information
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.plot_dist" class="md-nav__link">
    <span class="md-ellipsis">
      plot_dist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.plot_series" class="md-nav__link">
    <span class="md-ellipsis">
      plot_series
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.plot_diurnal_cycle" class="md-nav__link">
    <span class="md-ellipsis">
      plot_diurnal_cycle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.find_nearest_grid_point" class="md-nav__link">
    <span class="md-ellipsis">
      find_nearest_grid_point
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.plot_location_series" class="md-nav__link">
    <span class="md-ellipsis">
      plot_location_series
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.rainfall_cmap" class="md-nav__link">
    <span class="md-ellipsis">
      rainfall_cmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.prate_1hr_cmap" class="md-nav__link">
    <span class="md-ellipsis">
      prate_1hr_cmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.create_param_plot" class="md-nav__link">
    <span class="md-ellipsis">
      create_param_plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.create_bias_plot" class="md-nav__link">
    <span class="md-ellipsis">
      create_bias_plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.create_param_ani" class="md-nav__link">
    <span class="md-ellipsis">
      create_param_ani
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.create_bias_ani" class="md-nav__link">
    <span class="md-ellipsis">
      create_bias_ani
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.calculate_crude_track" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_crude_track
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.plot_extratropical_cyclone_track" class="md-nav__link">
    <span class="md-ellipsis">
      plot_extratropical_cyclone_track
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master.create_weather_map_ani" class="md-nav__link">
    <span class="md-ellipsis">
      create_weather_map_ani
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="api-reference">API Reference</h1>


<div class="doc doc-object doc-module">



<h2 id="master" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">master</span>


</h2>

    <div class="doc doc-contents first">









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="master.load_grib_files" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load_grib_files</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load_grib_files</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">standard_name</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Load multiple GRIB files from a folder, extract a parameter, and merge into a single Iris cube.</p>
<p>Each GRIB2 file is opened with Xarray (via cfgrib), converted to an Iris cube, 
and combined into a merged cube with unified time units and equalised attributes. 
Optionally, a constraint can be applied to extract a subset of the data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>folder</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the folder containing <code>.grib</code> or <code>.grib2</code> files.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>param</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Variable/parameter name in the GRIB files to load (e.g., 't2m' for 2m temperature).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>standard_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Standard name to assign to the variable for consistency with CF conventions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>constraint</code>
            </td>
            <td>
                  <code><span title="iris.Constraint">Constraint</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Constraint to filter the merged cube (e.g., by time, level, or region). 
Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>processed_cube</code></td>            <td>
                  <code><span title="iris.cube.Cube">Cube</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Merged Iris cube containing the requested parameter from all GRIB2 files.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>master.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_grib_files</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">standard_name</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load multiple GRIB files from a folder, extract a parameter, and merge into a single Iris cube.</span>

<span class="sd">    Each GRIB2 file is opened with Xarray (via cfgrib), converted to an Iris cube, </span>
<span class="sd">    and combined into a merged cube with unified time units and equalised attributes. </span>
<span class="sd">    Optionally, a constraint can be applied to extract a subset of the data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    folder : str</span>
<span class="sd">        Path to the folder containing `.grib` or `.grib2` files.</span>
<span class="sd">    param : str</span>
<span class="sd">        Variable/parameter name in the GRIB files to load (e.g., &#39;t2m&#39; for 2m temperature).</span>
<span class="sd">    standard_name : str</span>
<span class="sd">        Standard name to assign to the variable for consistency with CF conventions.</span>
<span class="sd">    constraint : iris.Constraint, optional</span>
<span class="sd">        Constraint to filter the merged cube (e.g., by time, level, or region). </span>
<span class="sd">        Default is None.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    processed_cube : iris.cube.Cube</span>
<span class="sd">        Merged Iris cube containing the requested parameter from all GRIB2 files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
	<span class="c1"># Get list of files.</span>
	<span class="n">files</span> <span class="o">=</span> <span class="p">[</span>
		<span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.grib&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.grib2&quot;</span><span class="p">))</span>
	<span class="p">]</span>

	<span class="c1"># Loop through files.</span>
	<span class="n">ds_cubes</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">cube</span><span class="o">.</span><span class="n">CubeList</span><span class="p">([])</span>
	<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
		<span class="c1"># Load file using Xarray via cfgrib.</span>
		<span class="n">ds_xarray</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span>
			<span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">file</span><span class="p">),</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;cfgrib&quot;</span><span class="p">,</span> <span class="n">decode_timedelta</span><span class="o">=</span><span class="kc">True</span>
		<span class="p">)[</span><span class="n">param</span><span class="p">]</span>
		<span class="n">ds_xarray</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;standard_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">standard_name</span>

		<span class="c1"># Convert to Iris cube.</span>
		<span class="n">ds_cube</span> <span class="o">=</span> <span class="n">ds_xarray</span><span class="o">.</span><span class="n">to_iris</span><span class="p">()</span>

		<span class="c1"># Append to cube list.</span>
		<span class="n">ds_cubes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds_cube</span><span class="p">)</span>

	<span class="c1"># Unify time units.</span>
	<span class="n">unify_time_units</span><span class="p">(</span><span class="n">ds_cubes</span><span class="p">)</span>
	<span class="c1"># Equalise attributes.</span>
	<span class="n">equalise_attributes</span><span class="p">(</span><span class="n">ds_cubes</span><span class="p">)</span>
	<span class="c1"># Concatenate.</span>
	<span class="n">processed_cube</span> <span class="o">=</span> <span class="n">ds_cubes</span><span class="o">.</span><span class="n">merge_cube</span><span class="p">()</span>

	<span class="c1"># Add constraint if relevant.</span>
	<span class="k">if</span> <span class="n">constraint</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
		<span class="c1"># Extract.</span>
		<span class="n">processed_cube</span> <span class="o">=</span> <span class="n">processed_cube</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">processed_cube</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="master.load_hclim_netcdf" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load_hclim_netcdf</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">load_hclim_netcdf</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Load a list of HCLIM NetCDF files, extract monthly subsets, and merge into a single cube.</p>
<p>Each input file is assumed to contain data for (at most) one full month. The function 
then constrains each cube to exactly one month using the first timestamp in the file, then 
concatenates all processed cubes into a single Iris cube. Optionally, a further constraint 
can be applied to the final cube.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>files</code>
            </td>
            <td>
                  <code>list of str or str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Paths to the NetCDF files to load. Can be a single file path or a list of paths.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>param</code>
            </td>
            <td>
                  <code><span title="str">str</span> or <span title="iris.Constraint">Constraint</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Variable/parameter to load from each file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>constraint</code>
            </td>
            <td>
                  <code><span title="iris.Constraint">Constraint</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Constraint to apply to the final merged cube (e.g., for a subset by time, level, or region). 
Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>processed_cube</code></td>            <td>
                  <code><span title="iris.cube.Cube">Cube</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Concatenated Iris cube containing the monthly subsets from all NetCDF files.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>master.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_hclim_netcdf</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load a list of HCLIM NetCDF files, extract monthly subsets, and merge into a single cube.</span>

<span class="sd">    Each input file is assumed to contain data for (at most) one full month. The function </span>
<span class="sd">    then constrains each cube to exactly one month using the first timestamp in the file, then </span>
<span class="sd">    concatenates all processed cubes into a single Iris cube. Optionally, a further constraint </span>
<span class="sd">    can be applied to the final cube.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    files : list of str or str</span>
<span class="sd">        Paths to the NetCDF files to load. Can be a single file path or a list of paths.</span>
<span class="sd">    param : str or iris.Constraint</span>
<span class="sd">        Variable/parameter to load from each file.</span>
<span class="sd">    constraint : iris.Constraint, optional</span>
<span class="sd">        Constraint to apply to the final merged cube (e.g., for a subset by time, level, or region). </span>
<span class="sd">        Default is None.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    processed_cube : iris.cube.Cube</span>
<span class="sd">        Concatenated Iris cube containing the monthly subsets from all NetCDF files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
	<span class="c1"># Load list of NetCDF files.</span>
	<span class="n">raw_cubes</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

	<span class="c1"># Loop through list of files.</span>
	<span class="n">processed_cubes</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">cube</span><span class="o">.</span><span class="n">CubeList</span><span class="p">([])</span>
	<span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">raw_cubes</span><span class="p">)):</span>
		<span class="c1"># Get cube.</span>
		<span class="n">raw_cube</span> <span class="o">=</span> <span class="n">raw_cubes</span><span class="p">[</span><span class="n">it</span><span class="p">]</span>

		<span class="c1"># Make sure each file only contains one month.</span>
		<span class="c1"># Get time coordinate.</span>
		<span class="n">cube_it_time</span> <span class="o">=</span> <span class="n">raw_cubes</span><span class="p">[</span><span class="n">it</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
		<span class="c1"># Get relevant date of the first day of the month.</span>
		<span class="n">first_date</span> <span class="o">=</span> <span class="n">cube_it_time</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span>
			<span class="n">cube_it_time</span><span class="o">.</span><span class="n">points</span>
		<span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">first_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span>
			<span class="n">first_date</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">first_date</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">first_date</span><span class="o">.</span><span class="n">day</span><span class="p">,</span>
			<span class="n">first_date</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">first_date</span><span class="o">.</span><span class="n">minute</span><span class="p">,</span> <span class="n">first_date</span><span class="o">.</span><span class="n">second</span>
		<span class="p">)</span>
		<span class="c1"># First day of next month.</span>
		<span class="n">last_date</span> <span class="o">=</span> <span class="n">first_date</span> <span class="o">+</span> <span class="n">relativedelta</span><span class="p">(</span><span class="n">months</span><span class="o">=+</span><span class="mi">1</span><span class="p">)</span>
		<span class="c1"># Create constraint.</span>
		<span class="n">month_constraint</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span>
			<span class="n">time</span><span class="o">=</span><span class="k">lambda</span> <span class="n">cell</span><span class="p">:</span> <span class="n">first_date</span> <span class="o">&lt;=</span> <span class="n">cell</span><span class="o">.</span><span class="n">point</span> <span class="o">&lt;</span> <span class="n">last_date</span>
		<span class="p">)</span>
		<span class="c1"># Extract based on constraint.</span>
		<span class="n">cube</span> <span class="o">=</span> <span class="n">raw_cube</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">month_constraint</span><span class="p">)</span>

		<span class="c1"># Append to list.</span>
		<span class="n">processed_cubes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cube</span><span class="p">)</span>

	<span class="c1"># Concatenate into a single cube.</span>
	<span class="c1"># Unify time units.</span>
	<span class="n">unify_time_units</span><span class="p">(</span><span class="n">processed_cubes</span><span class="p">)</span>
	<span class="c1"># Equalise attributes.</span>
	<span class="n">equalise_attributes</span><span class="p">(</span><span class="n">processed_cubes</span><span class="p">)</span>
	<span class="c1"># Concatenate.</span>
	<span class="n">processed_cube</span> <span class="o">=</span> <span class="n">processed_cubes</span><span class="o">.</span><span class="n">concatenate_cube</span><span class="p">()</span>

	<span class="c1"># Add constraint if relevant.</span>
	<span class="k">if</span> <span class="n">constraint</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
		<span class="c1"># Extract.</span>
		<span class="n">processed_cube</span> <span class="o">=</span> <span class="n">processed_cube</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">processed_cube</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="master.calculate_rainfall_accumulation" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">calculate_rainfall_accumulation</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">calculate_rainfall_accumulation</span><span class="p">(</span><span class="n">pr_cube_input</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute daily (09Z–09Z) rainfall accumulations from a time-series precipitation cube.</p>
<p>The function creates a categorised time coordinate that bins timesteps into
daily windows defined from 09:00 UTC on day <em>N</em> to 08:59:59 UTC on day <em>N+1</em>
(labelled internally at 21:00 UTC). It then sums precipitation over each bin,
converts the result to millimetres, and returns a cube of daily totals.
The first and last (potentially partial) bins are dropped.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pr_cube_input</code>
            </td>
            <td>
                  <code><span title="iris.cube.Cube">Cube</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time-series precipitation cube with a <code>time</code> coordinate.
Expected units are a rate convertible to <code>kg m-2 s-1</code> (e.g., mm/s),
sampled at regular <strong>3-hourly</strong> intervals. The 3-hourly cadence is
assumed for the conversion using <code>10800 s</code> per step.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>rainfall_cube</code></td>            <td>
                  <code><span title="iris.cube.Cube">Cube</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Daily precipitation totals aggregated over 09Z–09Z windows.
The cube has:
  - <code>standard_name</code> set to <code>'precipitation_amount'</code>
  - <code>long_name</code> set to <code>'Daily Total Precipitation Amount'</code>
  - <code>units</code> set to <code>'mm'</code>
The auxiliary categorisation coordinate is removed before returning.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>Conversion to millimetres assumes 3-hourly time steps and rate units of
  <code>kg m-2 s-1</code>: for each step, amount = rate × 10800 s, and
  <code>1 kg m-2 == 1 mm</code> water equivalent.</li>
<li>The first and last bins are sliced off (<code>[1:-1]</code>) to avoid partial days.</li>
<li>The internal day labels are placed at 21:00 UTC corresponding to the
  end of each 09Z–09Z window.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>master.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_rainfall_accumulation</span><span class="p">(</span><span class="n">pr_cube_input</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute daily (09Z–09Z) rainfall accumulations from a time-series precipitation cube.</span>

<span class="sd">    The function creates a categorised time coordinate that bins timesteps into</span>
<span class="sd">    daily windows defined from 09:00 UTC on day *N* to 08:59:59 UTC on day *N+1*</span>
<span class="sd">    (labelled internally at 21:00 UTC). It then sums precipitation over each bin,</span>
<span class="sd">    converts the result to millimetres, and returns a cube of daily totals.</span>
<span class="sd">    The first and last (potentially partial) bins are dropped.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pr_cube_input : iris.cube.Cube</span>
<span class="sd">        Time-series precipitation cube with a ``time`` coordinate.</span>
<span class="sd">        Expected units are a rate convertible to ``kg m-2 s-1`` (e.g., mm/s),</span>
<span class="sd">        sampled at regular **3-hourly** intervals. The 3-hourly cadence is</span>
<span class="sd">        assumed for the conversion using ``10800 s`` per step.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rainfall_cube : iris.cube.Cube</span>
<span class="sd">        Daily precipitation totals aggregated over 09Z–09Z windows.</span>
<span class="sd">        The cube has:</span>
<span class="sd">          - ``standard_name`` set to ``&#39;precipitation_amount&#39;``</span>
<span class="sd">          - ``long_name`` set to ``&#39;Daily Total Precipitation Amount&#39;``</span>
<span class="sd">          - ``units`` set to ``&#39;mm&#39;``</span>
<span class="sd">        The auxiliary categorisation coordinate is removed before returning.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - Conversion to millimetres assumes 3-hourly time steps and rate units of</span>
<span class="sd">      ``kg m-2 s-1``: for each step, amount = rate × 10800 s, and</span>
<span class="sd">      ``1 kg m-2 == 1 mm`` water equivalent.</span>
<span class="sd">    - The first and last bins are sliced off (``[1:-1]``) to avoid partial days.</span>
<span class="sd">    - The internal day labels are placed at 21:00 UTC corresponding to the</span>
<span class="sd">      end of each 09Z–09Z window.</span>
<span class="sd">    &quot;&quot;&quot;</span>
	<span class="c1"># Create coordinates categorisation function for days bewteen 09Z09.</span>
	<span class="k">def</span><span class="w"> </span><span class="nf">day_09z09</span><span class="p">(</span><span class="n">cube</span><span class="p">,</span> <span class="n">coord</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;day_09z09&quot;</span><span class="p">):</span>
		<span class="k">def</span><span class="w"> </span><span class="nf">_get_day</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
			<span class="c1"># Get specific timestep as datetime object.</span>
			<span class="n">date</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

			<span class="c1"># Define on day N at 09:00.</span>
			<span class="n">ref</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span>
				<span class="n">date</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">date</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">date</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="mi">9</span>
			<span class="p">)</span>

			<span class="c1"># Determine which day it falls within.</span>
			<span class="k">if</span> <span class="n">date</span> <span class="o">&gt;=</span> <span class="n">ref</span><span class="p">:</span>
				<span class="n">day</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">date</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">date</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">day</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span>
					<span class="n">date</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">date</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">date</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="mi">21</span>
				<span class="p">)</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=+</span><span class="mi">1</span><span class="p">)</span> 

			<span class="k">return</span> <span class="n">coord</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">date2num</span><span class="p">(</span><span class="n">day</span><span class="p">)</span>

		<span class="n">add_categorised_coord</span><span class="p">(</span><span class="n">cube</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">coord</span><span class="p">,</span> <span class="n">_get_day</span><span class="p">)</span>

	<span class="c1"># Add coordinates categorisation to cube.</span>
	<span class="n">day_09z09</span><span class="p">(</span><span class="n">pr_cube_input</span><span class="p">,</span> <span class="n">pr_cube_input</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">))</span>
	<span class="n">pr_cube_input</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;day_09z09&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">pr_cube_input</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">units</span>

	<span class="c1"># Calculate rainfall accumulation.</span>
	<span class="n">rainfall_cube</span> <span class="o">=</span> <span class="n">pr_cube_input</span><span class="o">.</span><span class="n">aggregated_by</span><span class="p">(</span><span class="s2">&quot;day_09z09&quot;</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">SUM</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

	<span class="c1"># Convert units to mm and change standard name.</span>
	<span class="n">rainfall_cube</span> <span class="o">*=</span> <span class="mi">10800</span>
	<span class="n">rainfall_cube</span><span class="o">.</span><span class="n">standard_name</span> <span class="o">=</span> <span class="s2">&quot;precipitation_amount&quot;</span>
	<span class="n">rainfall_cube</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;Daily Total Precipitation Amount&quot;</span>
	<span class="n">rainfall_cube</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;mm&quot;</span>

	<span class="c1"># Remove extra coordinates.</span>
	<span class="n">rainfall_cube</span><span class="o">.</span><span class="n">remove_coord</span><span class="p">(</span><span class="s2">&quot;day_09z09&quot;</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">rainfall_cube</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="master.create_rectilinear_cube" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_rectilinear_cube</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_rectilinear_cube</span><span class="p">(</span><span class="n">lon_min</span><span class="p">,</span> <span class="n">lon_max</span><span class="p">,</span> <span class="n">lat_min</span><span class="p">,</span> <span class="n">lat_max</span><span class="p">,</span> <span class="n">res</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a dummy Iris cube on a rectilinear latitude–longitude grid.</p>
<p>The function generates evenly spaced latitude and longitude points
between given bounds at the specified resolution, then builds a 
2D cube with zero-filled data on that grid. The cube can be used 
as a template or target grid for regridding operations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>lon_min</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum longitude of the grid (degrees east).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lon_max</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum longitude of the grid (degrees east). The range is
half-open: the last grid point is strictly less than <code>lon_max</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lat_min</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum latitude of the grid (degrees north).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lat_max</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum latitude of the grid (degrees north). The range is
half-open: the last grid point is strictly less than <code>lat_max</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>res</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Grid spacing in degrees for both latitude and longitude.
Default is 0.1 degrees.</p>
              </div>
            </td>
            <td>
                  <code>0.1</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dummy_cube</code></td>            <td>
                  <code><span title="iris.cube.Cube">Cube</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 2D cube of zeros with latitude and longitude as dimension
coordinates. Units are degrees, with a geographic coordinate
system (<code>GeogCS</code>) defined.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>The dummy data array is filled with zeros and has shape 
  <code>(n_lat, n_lon)</code>.</li>
<li>Longitude and latitude arrays are generated with 
  <code>numpy.arange(start, stop, res)</code>, so the upper bounds
  (<code>lon_max</code>, <code>lat_max</code>) are <strong>exclusive</strong>.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>master.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_rectilinear_cube</span><span class="p">(</span><span class="n">lon_min</span><span class="p">,</span> <span class="n">lon_max</span><span class="p">,</span> <span class="n">lat_min</span><span class="p">,</span> <span class="n">lat_max</span><span class="p">,</span> <span class="n">res</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a dummy Iris cube on a rectilinear latitude–longitude grid.</span>

<span class="sd">    The function generates evenly spaced latitude and longitude points</span>
<span class="sd">    between given bounds at the specified resolution, then builds a </span>
<span class="sd">    2D cube with zero-filled data on that grid. The cube can be used </span>
<span class="sd">    as a template or target grid for regridding operations.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lon_min : float</span>
<span class="sd">        Minimum longitude of the grid (degrees east).</span>
<span class="sd">    lon_max : float</span>
<span class="sd">        Maximum longitude of the grid (degrees east). The range is</span>
<span class="sd">        half-open: the last grid point is strictly less than `lon_max`.</span>
<span class="sd">    lat_min : float</span>
<span class="sd">        Minimum latitude of the grid (degrees north).</span>
<span class="sd">    lat_max : float</span>
<span class="sd">        Maximum latitude of the grid (degrees north). The range is</span>
<span class="sd">        half-open: the last grid point is strictly less than `lat_max`.</span>
<span class="sd">    res : float, optional</span>
<span class="sd">        Grid spacing in degrees for both latitude and longitude.</span>
<span class="sd">        Default is 0.1 degrees.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dummy_cube : iris.cube.Cube</span>
<span class="sd">        A 2D cube of zeros with latitude and longitude as dimension</span>
<span class="sd">        coordinates. Units are degrees, with a geographic coordinate</span>
<span class="sd">        system (`GeogCS`) defined.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - The dummy data array is filled with zeros and has shape </span>
<span class="sd">      `(n_lat, n_lon)`.</span>
<span class="sd">    - Longitude and latitude arrays are generated with </span>
<span class="sd">      ``numpy.arange(start, stop, res)``, so the upper bounds</span>
<span class="sd">      (`lon_max`, `lat_max`) are **exclusive**.</span>
<span class="sd">    &quot;&quot;&quot;</span>
	<span class="c1"># Define coordinates.</span>
	<span class="n">lat_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">lat_min</span><span class="p">,</span> <span class="n">lat_max</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>      
	<span class="n">lon_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">lon_min</span><span class="p">,</span> <span class="n">lon_max</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>  

	<span class="n">latitude</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">DimCoord</span><span class="p">(</span>
		<span class="n">lat_points</span><span class="p">,</span> <span class="n">standard_name</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;degrees&#39;</span><span class="p">,</span>
		<span class="n">coord_system</span><span class="o">=</span><span class="n">iris</span><span class="o">.</span><span class="n">coord_systems</span><span class="o">.</span><span class="n">GeogCS</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">fileformats</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">EARTH_RADIUS</span><span class="p">)</span>
	<span class="p">)</span>
	<span class="n">longitude</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">DimCoord</span><span class="p">(</span>
		<span class="n">lon_points</span><span class="p">,</span> <span class="n">standard_name</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;degrees&#39;</span><span class="p">,</span>
		<span class="n">coord_system</span><span class="o">=</span><span class="n">iris</span><span class="o">.</span><span class="n">coord_systems</span><span class="o">.</span><span class="n">GeogCS</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">fileformats</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">EARTH_RADIUS</span><span class="p">)</span>
	<span class="p">)</span>

	<span class="c1"># Create a dummy cube with the target grid.</span>
	<span class="n">dummy_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">lat_points</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">lon_points</span><span class="p">)))</span>
	<span class="n">dummy_cube</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">cube</span><span class="o">.</span><span class="n">Cube</span><span class="p">(</span>
		<span class="n">dummy_data</span><span class="p">,</span>
		<span class="n">dim_coords_and_dims</span><span class="o">=</span><span class="p">[</span>
			<span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
			<span class="p">(</span><span class="n">longitude</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
		<span class="p">],</span>
	<span class="p">)</span>

	<span class="k">return</span> <span class="n">dummy_cube</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="master.regrid_cube" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">regrid_cube</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">regrid_cube</span><span class="p">(</span><span class="n">basis_cube</span><span class="p">,</span> <span class="n">target_cube</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Regrid a cube onto the grid of another cube.</p>
<p>Currently only supports bilinear interpolation using the
ESMF regridding scheme.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>basis_cube</code>
            </td>
            <td>
                  <code><span title="iris.cube.Cube">Cube</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The reference cube that defines the target grid 
(lat/lon resolution, extent, coordinate system).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_cube</code>
            </td>
            <td>
                  <code><span title="iris.cube.Cube">Cube</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input cube to be regridded to the grid of <code>basis_cube</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>scheme</code>
            </td>
            <td>
                  <code><span title="bilinear">bilinear</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Regridding scheme to use. Currently only <code>'bilinear'</code> is supported,
which applies <code>ESMFBilinear</code>. Default is <code>'bilinear'</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;bilinear&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>regridded_cube</code></td>            <td>
                  <code><span title="iris.cube.Cube">Cube</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The regridded cube on the grid of <code>basis_cube</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NotImplementedError">NotImplementedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a scheme other than <code>'bilinear'</code> is specified.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>master.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">regrid_cube</span><span class="p">(</span><span class="n">basis_cube</span><span class="p">,</span> <span class="n">target_cube</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s2">&quot;bilinear&quot;</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Regrid a cube onto the grid of another cube.</span>

<span class="sd">    Currently only supports bilinear interpolation using the</span>
<span class="sd">    ESMF regridding scheme.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    basis_cube : iris.cube.Cube</span>
<span class="sd">        The reference cube that defines the target grid </span>
<span class="sd">        (lat/lon resolution, extent, coordinate system).</span>
<span class="sd">    target_cube : iris.cube.Cube</span>
<span class="sd">        The input cube to be regridded to the grid of `basis_cube`.</span>
<span class="sd">    scheme : {&#39;bilinear&#39;}, optional</span>
<span class="sd">        Regridding scheme to use. Currently only ``&#39;bilinear&#39;`` is supported,</span>
<span class="sd">        which applies `ESMFBilinear`. Default is ``&#39;bilinear&#39;``.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    regridded_cube : iris.cube.Cube</span>
<span class="sd">        The regridded cube on the grid of `basis_cube`.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    NotImplementedError</span>
<span class="sd">        If a scheme other than ``&#39;bilinear&#39;`` is specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
	<span class="c1"># Regrid target cube to basis cube coordinates.</span>
	<span class="k">if</span> <span class="n">scheme</span> <span class="o">==</span> <span class="s2">&quot;bilinear&quot;</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">target_cube</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span><span class="n">basis_cube</span><span class="p">,</span> <span class="n">ESMFBilinear</span><span class="p">())</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Other regridding methods have not been implemented.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="master.extract_common_period" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">extract_common_period</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">extract_common_period</span><span class="p">(</span><span class="n">cubes</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Extract the common overlapping time period across multiple cubes.</p>
<p>This function ensures all cubes use a standard calendar, unifies their 
time units, determines the maximum overlapping time range, and returns 
each cube constrained to that period.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cubes</code>
            </td>
            <td>
                  <code>list of iris.cube.Cube</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input cubes with a <code>time</code> coordinate. Each cube may have 
different time ranges, calendars, or units.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>constrained_cubes</code></td>            <td>
                  <code>list of iris.cube.Cube</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of cubes extracted to the common overlapping time period.
Each cube has unified time units and standard calendar.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If no overlapping time period exists between the cubes.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="iris.exceptions.CoordinateNotFoundError">CoordinateNotFoundError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a cube does not have a <code>time</code> coordinate.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>master.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">extract_common_period</span><span class="p">(</span><span class="n">cubes</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract the common overlapping time period across multiple cubes.</span>

<span class="sd">    This function ensures all cubes use a standard calendar, unifies their </span>
<span class="sd">    time units, determines the maximum overlapping time range, and returns </span>
<span class="sd">    each cube constrained to that period.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cubes : list of iris.cube.Cube</span>
<span class="sd">        Input cubes with a ``time`` coordinate. Each cube may have </span>
<span class="sd">        different time ranges, calendars, or units.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    constrained_cubes : list of iris.cube.Cube</span>
<span class="sd">        List of cubes extracted to the common overlapping time period.</span>
<span class="sd">        Each cube has unified time units and standard calendar.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If no overlapping time period exists between the cubes.</span>
<span class="sd">    iris.exceptions.CoordinateNotFoundError</span>
<span class="sd">        If a cube does not have a ``time`` coordinate.</span>
<span class="sd">    &quot;&quot;&quot;</span>
	<span class="c1"># Loop through each cube.</span>
	<span class="n">common_calendar_cubes</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">cube</span> <span class="ow">in</span> <span class="n">cubes</span><span class="p">:</span>
		<span class="c1"># Convert to standard calendar.</span>
		<span class="n">cube</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">cf_units</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span>
			<span class="n">cube</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">origin</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="s2">&quot;standard&quot;</span>
		<span class="p">)</span>
		<span class="n">common_calendar_cubes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cube</span><span class="p">)</span>

	<span class="c1"># Unify time units.</span>
	<span class="n">unified_cubes</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">cube</span><span class="o">.</span><span class="n">CubeList</span><span class="p">(</span><span class="n">common_calendar_cubes</span><span class="p">)</span>
	<span class="n">unify_time_units</span><span class="p">(</span><span class="n">unified_cubes</span><span class="p">)</span>

	<span class="c1"># Extract the time coordinates for all cubes</span>
	<span class="n">time_ranges</span> <span class="o">=</span> <span class="p">[]</span>

	<span class="c1"># Loop through to get start and end dates.</span>
	<span class="k">for</span> <span class="n">cube</span> <span class="ow">in</span> <span class="n">unified_cubes</span><span class="p">:</span>
		<span class="c1"># Get time coordinate.</span>
		<span class="n">time_coord</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>

		<span class="c1"># Get points.</span>
		<span class="n">times</span> <span class="o">=</span> <span class="n">time_coord</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">time_coord</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>

		<span class="c1"># Append start and end dates.</span>
		<span class="n">time_ranges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

    <span class="c1"># Compute the max start time and min end time</span>
	<span class="n">start_times</span><span class="p">,</span> <span class="n">end_times</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">time_ranges</span><span class="p">)</span>
	<span class="n">common_start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">start_times</span><span class="p">)</span>
	<span class="n">common_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">end_times</span><span class="p">)</span>

	<span class="c1"># Raise error if there is not overlap.</span>
	<span class="k">if</span> <span class="n">common_start</span> <span class="o">&gt;=</span> <span class="n">common_end</span><span class="p">:</span>
		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No overlapping time period found across cubes.&quot;</span><span class="p">)</span>

	<span class="c1"># Create constraint.</span>
	<span class="n">constraint</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span>
		<span class="n">time</span><span class="o">=</span><span class="k">lambda</span> <span class="n">cell</span><span class="p">:</span> <span class="n">common_start</span> <span class="o">&lt;=</span> <span class="n">cell</span><span class="o">.</span><span class="n">point</span> <span class="o">&lt;=</span> <span class="n">common_end</span>
	<span class="p">)</span>

	<span class="c1"># Define constrained cubes</span>
	<span class="n">constrained_cubes</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">cube</span> <span class="ow">in</span> <span class="n">unified_cubes</span><span class="p">:</span>
		<span class="c1"># Extract relevant period.</span>
		<span class="n">constrained_cube</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>

		<span class="c1"># Append to list.</span>
		<span class="n">constrained_cubes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">constrained_cube</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">constrained_cubes</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="master.add_statistical_information" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_statistical_information</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_statistical_information</span><span class="p">(</span><span class="n">cube_data</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Add basic statistical information as annotations on a plot.</p>
<p>Computes and displays mean absolute value, standard deviation,
and mean bias of the input data, then adds them as anchored text
boxes to the provided Matplotlib axis.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cube_data</code>
            </td>
            <td>
                  <code><span title="array_like">array_like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input data array (e.g., model errors, residuals). Can be any 
NumPy-compatible sequence of values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unit</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String label for the physical unit of the data (e.g., 'K', 'mm').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ax</code>
            </td>
            <td>
                  <code><span title="matplotlib.axes.Axes">Axes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matplotlib axis object to which the annotations will be added.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>success</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns <code>True</code> after successfully adding the annotations.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>
<p>Statistics added to the axis:</p>
</li>
<li>
<p><strong>Mean absolute value</strong>: :math:<code>|ar{x}|</code>  </p>
</li>
<li><strong>Standard deviation</strong>: :math:<code>s</code> (with Bessel's correction, ddof=1)  </li>
<li>
<p><strong>Mean bias</strong>: :math:<code>ar{x}</code>  </p>
</li>
<li>
<p>Anchored positions:</p>
</li>
<li>
<p>Mean absolute value and standard deviation → bottom-right (loc=4).  </p>
</li>
<li>Mean bias → top-left (loc=2).  </li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_statistical_information</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>master.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_statistical_information</span><span class="p">(</span><span class="n">cube_data</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add basic statistical information as annotations on a plot.</span>

<span class="sd">    Computes and displays mean absolute value, standard deviation,</span>
<span class="sd">    and mean bias of the input data, then adds them as anchored text</span>
<span class="sd">    boxes to the provided Matplotlib axis.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cube_data : array_like</span>
<span class="sd">        Input data array (e.g., model errors, residuals). Can be any </span>
<span class="sd">        NumPy-compatible sequence of values.</span>
<span class="sd">    unit : str</span>
<span class="sd">        String label for the physical unit of the data (e.g., &#39;K&#39;, &#39;mm&#39;).</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Matplotlib axis object to which the annotations will be added.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    success : bool</span>
<span class="sd">        Returns ``True`` after successfully adding the annotations.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - Statistics added to the axis:</span>

<span class="sd">      * **Mean absolute value**: :math:`|\bar{x}|`  </span>
<span class="sd">      * **Standard deviation**: :math:`s` (with Bessel&#39;s correction, ddof=1)  </span>
<span class="sd">      * **Mean bias**: :math:`\bar{x}`  </span>

<span class="sd">    - Anchored positions:</span>

<span class="sd">      * Mean absolute value and standard deviation → bottom-right (loc=4).  </span>
<span class="sd">      * Mean bias → top-left (loc=2).  </span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; fig, ax = plt.subplots()</span>
<span class="sd">    &gt;&gt;&gt; data = np.random.randn(100)</span>
<span class="sd">    &gt;&gt;&gt; add_statistical_information(data, &#39;K&#39;, ax)</span>
<span class="sd">    True</span>
<span class="sd">    &quot;&quot;&quot;</span>
	<span class="c1"># Calculate relevant statistical information.</span>
	<span class="c1"># Calculate mean absolute error.</span>
	<span class="n">txt_cube</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$|\bar</span><span class="si">{x}</span><span class="s1">| = $&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
		<span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cube_data</span><span class="p">)),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">unit</span>
	<span class="p">)</span>
	<span class="c1"># Calculate standard deviation.</span>
	<span class="n">txt_cube</span> <span class="o">+=</span> <span class="sa">r</span><span class="s1">&#39;$s = $&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
		<span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cube_data</span><span class="p">),</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">unit</span>
	<span class="p">)</span>
	<span class="c1"># Calculate mean bias.</span>
	<span class="n">txt_cube_bias</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\bar</span><span class="si">{x}</span><span class="s1"> = $&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
		<span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cube_data</span><span class="p">)),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">unit</span>
	<span class="p">)</span>

	<span class="c1"># Add to plots.</span>
	<span class="c1"># Lower right hand side.</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">AnchoredText</span><span class="p">(</span><span class="n">txt_cube</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
	<span class="c1"># Top left hand side.</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">AnchoredText</span><span class="p">(</span><span class="n">txt_cube_bias</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

	<span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="master.plot_dist" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">plot_dist</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot_dist</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">subtitles</span><span class="p">,</span> <span class="n">nbins</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Plot histograms of multiple Iris cubes in a grid layout with statistical annotations.</p>
<p>Each subplot corresponds to one cube, drawn as a histogram of its flattened
data values with the specified number of bins. Titles, labels, axis limits,
and statistical information (mean absolute value, standard deviation, and mean bias)
are added to each subplot. The entire figure is saved to file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ds</code>
            </td>
            <td>
                  <code>list of list of iris.cube.Cube</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nested list (2D structure) of Iris cubes. Each element <code>ds[i][j]</code> is an
Iris cube; its <code>.data</code> values are flattened into a histogram.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Main title for the entire figure (suptitle).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subtitles</code>
            </td>
            <td>
                  <code>list of list of str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nested list of subplot titles, same shape as <code>ds</code>. <code>subtitles[i][j]</code> is the title
for subplot (i, j).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nbins</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bins to use in each histogram.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xlabel</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for the x-axis of each subplot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unit</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unit string to display in statistical annotations (e.g., 'K', 'mm').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fname</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path (including filename) where the figure will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code>tuple of float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Figure size in inches, e.g., (width, height).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xlim</code>
            </td>
            <td>
                  <code>tuple of float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>x-axis limits as (xmin, xmax). Default is None (auto-scaled).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ylim</code>
            </td>
            <td>
                  <code>tuple of float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>y-axis limits as (ymin, ymax). Default is None (auto-scaled).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>success</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns <code>True</code> after successfully creating and saving the plot.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>master.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_dist</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">subtitles</span><span class="p">,</span> <span class="n">nbins</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot histograms of multiple Iris cubes in a grid layout with statistical annotations.</span>

<span class="sd">    Each subplot corresponds to one cube, drawn as a histogram of its flattened</span>
<span class="sd">    data values with the specified number of bins. Titles, labels, axis limits,</span>
<span class="sd">    and statistical information (mean absolute value, standard deviation, and mean bias)</span>
<span class="sd">    are added to each subplot. The entire figure is saved to file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ds : list of list of iris.cube.Cube</span>
<span class="sd">        Nested list (2D structure) of Iris cubes. Each element `ds[i][j]` is an</span>
<span class="sd">        Iris cube; its `.data` values are flattened into a histogram.</span>
<span class="sd">    title : str</span>
<span class="sd">        Main title for the entire figure (suptitle).</span>
<span class="sd">    subtitles : list of list of str</span>
<span class="sd">        Nested list of subplot titles, same shape as `ds`. `subtitles[i][j]` is the title</span>
<span class="sd">        for subplot (i, j).</span>
<span class="sd">    nbins : int</span>
<span class="sd">        Number of bins to use in each histogram.</span>
<span class="sd">    xlabel : str</span>
<span class="sd">        Label for the x-axis of each subplot.</span>
<span class="sd">    unit : str</span>
<span class="sd">        Unit string to display in statistical annotations (e.g., &#39;K&#39;, &#39;mm&#39;).</span>
<span class="sd">    fname : str</span>
<span class="sd">        Path (including filename) where the figure will be saved.</span>
<span class="sd">    size : tuple of float</span>
<span class="sd">        Figure size in inches, e.g., (width, height).</span>
<span class="sd">    xlim : tuple of float, optional</span>
<span class="sd">        x-axis limits as (xmin, xmax). Default is None (auto-scaled).</span>
<span class="sd">    ylim : tuple of float, optional</span>
<span class="sd">        y-axis limits as (ymin, ymax). Default is None (auto-scaled).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    success : bool</span>
<span class="sd">        Returns ``True`` after successfully creating and saving the plot.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Determine number of rows.</span>
	<span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
	<span class="n">ncols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

	<span class="c1"># Create plot space.</span>
	<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

	<span class="c1"># Loop through datasets.</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
			<span class="c1"># Create histogram.</span>
			<span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="n">nbins</span><span class="p">)</span>

			<span class="c1"># Add subplot title.</span>
			<span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">subtitles</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>

			<span class="c1"># Set axis label.</span>
			<span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>

			<span class="c1"># Set axes limit.</span>
			<span class="k">if</span> <span class="n">xlim</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
				<span class="c1"># x-axis.</span>
				<span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">ylim</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
				<span class="c1"># y-axis.</span>
				<span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>

			<span class="c1"># Remove ytick labels.</span>
			<span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>

			<span class="c1"># Add statistical information.</span>
			<span class="n">add_statistical_information</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>

	<span class="c1"># Add title.</span>
	<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

	<span class="c1"># Change size.</span>
	<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

	<span class="c1"># Save result.</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

	<span class="c1"># Output information.</span>
	<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Created distribution successfully&quot;</span><span class="p">)</span>

	<span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="master.plot_series" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">plot_series</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot_series</span><span class="p">(</span><span class="n">cubes</span><span class="p">,</span> <span class="n">operation</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Plot time series of spatially aggregated Iris cubes.</p>
<p>Each input cube is collapsed over latitude and longitude using the
specified aggregation operation, producing a single time series per cube.
The resulting series are plotted together with labels, a title, and y-axis
label, and the figure is saved to file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cubes</code>
            </td>
            <td>
                  <code>list of iris.cube.Cube</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of Iris cubes, each containing a <code>time</code> coordinate and 
2D spatial coordinates <code>latitude</code> and <code>longitude</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>operation</code>
            </td>
            <td>
                  <code><span title="function">function</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Aggregation function used in the collapse, e.g. 
<code>iris.analysis.MEAN</code> or <code>iris.analysis.SUM</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Title for the plot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>labels</code>
            </td>
            <td>
                  <code>list of str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labels for the plotted time series, one per cube.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ylabel</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for the y-axis (e.g., 'Temperature (K)', 'Precipitation (mm/day)').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fname</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path (including filename) where the figure will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>success</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns <code>True</code> after successfully creating and saving the plot.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>The series are collapsed spatially over <code>['longitude', 'latitude']</code>.</li>
<li>The x-axis is formatted for dates automatically.</li>
<li>The output is saved at 300 dpi.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>master.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_series</span><span class="p">(</span><span class="n">cubes</span><span class="p">,</span> <span class="n">operation</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">fname</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot time series of spatially aggregated Iris cubes.</span>

<span class="sd">    Each input cube is collapsed over latitude and longitude using the</span>
<span class="sd">    specified aggregation operation, producing a single time series per cube.</span>
<span class="sd">    The resulting series are plotted together with labels, a title, and y-axis</span>
<span class="sd">    label, and the figure is saved to file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cubes : list of iris.cube.Cube</span>
<span class="sd">        List of Iris cubes, each containing a ``time`` coordinate and </span>
<span class="sd">        2D spatial coordinates ``latitude`` and ``longitude``.</span>
<span class="sd">    operation : function</span>
<span class="sd">        Aggregation function used in the collapse, e.g. </span>
<span class="sd">        ``iris.analysis.MEAN`` or ``iris.analysis.SUM``.</span>
<span class="sd">    title : str</span>
<span class="sd">        Title for the plot.</span>
<span class="sd">    labels : list of str</span>
<span class="sd">        Labels for the plotted time series, one per cube.</span>
<span class="sd">    ylabel : str</span>
<span class="sd">        Label for the y-axis (e.g., &#39;Temperature (K)&#39;, &#39;Precipitation (mm/day)&#39;).</span>
<span class="sd">    fname : str</span>
<span class="sd">        Path (including filename) where the figure will be saved.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    success : bool</span>
<span class="sd">        Returns ``True`` after successfully creating and saving the plot.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - The series are collapsed spatially over ``[&#39;longitude&#39;, &#39;latitude&#39;]``.</span>
<span class="sd">    - The x-axis is formatted for dates automatically.</span>
<span class="sd">    - The output is saved at 300 dpi.</span>
<span class="sd">    &quot;&quot;&quot;</span>
	<span class="c1"># Determine number of rows.</span>
	<span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cubes</span><span class="p">)</span>

	<span class="c1"># Loop through datasets.</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
		<span class="c1"># Calculate mean spatial mean at each timestep.</span>
		<span class="n">series_cube</span> <span class="o">=</span> <span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">collapsed</span><span class="p">(</span>
			<span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">operation</span>
		<span class="p">)</span>

		<span class="c1"># Create plot.</span>
		<span class="n">iplt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">series_cube</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

	<span class="c1"># Deal with x-axis ticks.</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>

	<span class="c1"># Set axis label.</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>

	<span class="c1"># Put a grid on the plot.</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

	<span class="c1"># Add legend.</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

	<span class="c1"># Add title.</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

	<span class="c1"># Save result.</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

	<span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="master.plot_diurnal_cycle" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">plot_diurnal_cycle</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot_diurnal_cycle</span><span class="p">(</span><span class="n">cubes</span><span class="p">,</span> <span class="n">operation</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Plot the diurnal cycle of one or more Iris cubes.</p>
<p>For each cube, the function bins data by hour of the day (from the <code>time</code>
coordinate), applies the specified aggregation operation within each hour,
collapses over spatial dimensions, and plots the resulting hourly cycle.
The figure is saved to file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cubes</code>
            </td>
            <td>
                  <code>list of iris.cube.Cube</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of Iris cubes, each containing a <code>time</code> coordinate and
2D spatial coordinates <code>latitude</code> and <code>longitude</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>operation</code>
            </td>
            <td>
                  <code><span title="function">function</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Aggregation function used for both hourly grouping and spatial 
collapse, e.g. <code>iris.analysis.MEAN</code>, <code>iris.analysis.SUM</code>,
<code>iris.analysis.MAX</code>, etc.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Title for the plot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>labels</code>
            </td>
            <td>
                  <code>list of str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labels for each plotted diurnal cycle, one per cube.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ylabel</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for the y-axis (e.g., 'Temperature (K)', 'Precipitation (mm/hr)').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fname</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path (including filename) where the figure will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>success</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns <code>True</code> after successfully creating and saving the plot.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>The <code>hour</code> coordinate is added dynamically via 
  :func:<code>iris.coord_categorisation.add_hour</code>.</li>
<li>Each cube is collapsed spatially over <code>['latitude', 'longitude']</code> 
  using the provided <code>operation</code>.</li>
<li>The x-axis runs from 0–23 hours.</li>
<li>The figure is saved at 300 dpi.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>master.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_diurnal_cycle</span><span class="p">(</span><span class="n">cubes</span><span class="p">,</span> <span class="n">operation</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">fname</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the diurnal cycle of one or more Iris cubes.</span>

<span class="sd">    For each cube, the function bins data by hour of the day (from the ``time``</span>
<span class="sd">    coordinate), applies the specified aggregation operation within each hour,</span>
<span class="sd">    collapses over spatial dimensions, and plots the resulting hourly cycle.</span>
<span class="sd">    The figure is saved to file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cubes : list of iris.cube.Cube</span>
<span class="sd">        List of Iris cubes, each containing a ``time`` coordinate and</span>
<span class="sd">        2D spatial coordinates ``latitude`` and ``longitude``.</span>
<span class="sd">    operation : function</span>
<span class="sd">        Aggregation function used for both hourly grouping and spatial </span>
<span class="sd">        collapse, e.g. ``iris.analysis.MEAN``, ``iris.analysis.SUM``,</span>
<span class="sd">        ``iris.analysis.MAX``, etc.</span>
<span class="sd">    title : str</span>
<span class="sd">        Title for the plot.</span>
<span class="sd">    labels : list of str</span>
<span class="sd">        Labels for each plotted diurnal cycle, one per cube.</span>
<span class="sd">    ylabel : str</span>
<span class="sd">        Label for the y-axis (e.g., &#39;Temperature (K)&#39;, &#39;Precipitation (mm/hr)&#39;).</span>
<span class="sd">    fname : str</span>
<span class="sd">        Path (including filename) where the figure will be saved.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    success : bool</span>
<span class="sd">        Returns ``True`` after successfully creating and saving the plot.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - The ``hour`` coordinate is added dynamically via </span>
<span class="sd">      :func:`iris.coord_categorisation.add_hour`.</span>
<span class="sd">    - Each cube is collapsed spatially over ``[&#39;latitude&#39;, &#39;longitude&#39;]`` </span>
<span class="sd">      using the provided `operation`.</span>
<span class="sd">    - The x-axis runs from 0–23 hours.</span>
<span class="sd">    - The figure is saved at 300 dpi.</span>
<span class="sd">    &quot;&quot;&quot;</span>
	<span class="c1"># Determine number of rows.</span>
	<span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cubes</span><span class="p">)</span>

	<span class="c1"># Get timesteps for x-axis.</span>
	<span class="n">cube_time</span> <span class="o">=</span> <span class="n">cubes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
	<span class="n">steps</span> <span class="o">=</span> <span class="n">cube_time</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">cube_time</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>

	<span class="c1"># Loop through datasets.</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
		<span class="c1"># Get cube.</span>
		<span class="n">cube</span> <span class="o">=</span> <span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

		<span class="c1"># Add an &#39;hour&#39; coordinate to the cube</span>
		<span class="n">iris</span><span class="o">.</span><span class="n">coord_categorisation</span><span class="o">.</span><span class="n">add_hour</span><span class="p">(</span><span class="n">cube</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;hour&quot;</span><span class="p">)</span>

		<span class="c1"># Calculate mean spatial mean at each timestep.</span>
		<span class="n">diurnal_cycle</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">aggregated_by</span><span class="p">(</span><span class="s2">&quot;hour&quot;</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>

		<span class="c1"># Collapse spatial dimensions to get mean temperature for each hour</span>
		<span class="n">diurnal_operation</span> <span class="o">=</span> <span class="n">diurnal_cycle</span><span class="o">.</span><span class="n">collapsed</span><span class="p">(</span>
			<span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">operation</span>
		<span class="p">)</span>

		<span class="c1"># Get time.</span>
		<span class="n">t</span> <span class="o">=</span> <span class="n">diurnal_operation</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;hour&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span>

		<span class="c1"># Create plot.</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">diurnal_operation</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

	<span class="c1"># Set axis labels.</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Hour&quot;</span><span class="p">)</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>

	<span class="c1"># Add legend.</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

	<span class="c1"># Add title.</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

	<span class="c1"># Save result.</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

	<span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="master.find_nearest_grid_point" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">find_nearest_grid_point</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">find_nearest_grid_point</span><span class="p">(</span><span class="n">cube</span><span class="p">,</span> <span class="n">target_lat</span><span class="p">,</span> <span class="n">target_lon</span><span class="p">,</span> <span class="n">max_search_radius</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Extract the time series at the nearest <em>valid</em> grid point to a target lat/lon.</p>
<p>The function first finds the nearest latitude/longitude indices to the target.
If the corresponding grid cell has valid data (not masked/NaN) in the first
time slice, it returns that time series. Otherwise, it searches within a
square neighborhood around the initial index (up to <code>max_search_radius</code>
grid cells away in each direction) and returns the time series at the closest
valid grid cell to the target coordinates.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cube</code>
            </td>
            <td>
                  <code><span title="iris.cube.Cube">Cube</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data cube with dimensions ordered as <code>(time, latitude, longitude)</code>.
The first time slice is used to determine validity (mask/NaN).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_lat</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target latitude in degrees north.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_lon</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target longitude in degrees east (same convention/range as the cube).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_search_radius</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum search radius <strong>in grid cells</strong> around the initial nearest
index, used only if the initial point is invalid. Default is <code>5</code>.</p>
              </div>
            </td>
            <td>
                  <code>5</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>time_series</code></td>            <td>
                  <code><span title="iris.cube.Cube">Cube</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D cube (over <code>time</code>) extracted at the selected grid cell.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If no valid grid point is found within the search neighborhood.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>Validity is checked on the <strong>first</strong> time slice only.</li>
<li>Distance is computed in index space using a simple Euclidean metric on
  lat/lon degrees (<code>np.hypot</code>). For small neighborhoods this is adequate.</li>
<li><code>max_search_radius</code> is in <strong>index units</strong>, not degrees. For example,
  if your grid spacing is 0.1°, a radius of 5 covers ±0.5° around the
  initial nearest-neighbor index.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>master.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_nearest_grid_point</span><span class="p">(</span><span class="n">cube</span><span class="p">,</span> <span class="n">target_lat</span><span class="p">,</span> <span class="n">target_lon</span><span class="p">,</span> <span class="n">max_search_radius</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract the time series at the nearest *valid* grid point to a target lat/lon.</span>

<span class="sd">    The function first finds the nearest latitude/longitude indices to the target.</span>
<span class="sd">    If the corresponding grid cell has valid data (not masked/NaN) in the first</span>
<span class="sd">    time slice, it returns that time series. Otherwise, it searches within a</span>
<span class="sd">    square neighborhood around the initial index (up to `max_search_radius`</span>
<span class="sd">    grid cells away in each direction) and returns the time series at the closest</span>
<span class="sd">    valid grid cell to the target coordinates.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cube : iris.cube.Cube</span>
<span class="sd">        Data cube with dimensions ordered as ``(time, latitude, longitude)``.</span>
<span class="sd">        The first time slice is used to determine validity (mask/NaN).</span>
<span class="sd">    target_lat : float</span>
<span class="sd">        Target latitude in degrees north.</span>
<span class="sd">    target_lon : float</span>
<span class="sd">        Target longitude in degrees east (same convention/range as the cube).</span>
<span class="sd">    max_search_radius : int, optional</span>
<span class="sd">        Maximum search radius **in grid cells** around the initial nearest</span>
<span class="sd">        index, used only if the initial point is invalid. Default is ``5``.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    time_series : iris.cube.Cube</span>
<span class="sd">        A 1D cube (over ``time``) extracted at the selected grid cell.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If no valid grid point is found within the search neighborhood.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - Validity is checked on the **first** time slice only.</span>
<span class="sd">    - Distance is computed in index space using a simple Euclidean metric on</span>
<span class="sd">      lat/lon degrees (``np.hypot``). For small neighborhoods this is adequate.</span>
<span class="sd">    - `max_search_radius` is in **index units**, not degrees. For example,</span>
<span class="sd">      if your grid spacing is 0.1°, a radius of 5 covers ±0.5° around the</span>
<span class="sd">      initial nearest-neighbor index.</span>
<span class="sd">    &quot;&quot;&quot;</span>
	<span class="c1"># Get longitude and latitude array.</span>
	<span class="n">lats</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span>
	<span class="n">lons</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span>

	<span class="c1"># Get initial index of nearest neighbour.</span>
	<span class="n">lat_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">lats</span> <span class="o">-</span> <span class="n">target_lat</span><span class="p">)</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
	<span class="n">lon_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">lons</span> <span class="o">-</span> <span class="n">target_lon</span><span class="p">)</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>

	<span class="c1"># Get the first time slice as data.</span>
	<span class="n">data</span> <span class="o">=</span> <span class="n">cube</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

    <span class="c1"># Check if that point has valid data</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">is_masked</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">lat_idx</span><span class="p">,</span> <span class="n">lon_idx</span><span class="p">])</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">lat_idx</span><span class="p">,</span> <span class="n">lon_idx</span><span class="p">]):</span>
		<span class="k">return</span> <span class="n">cube</span><span class="p">[:,</span> <span class="n">lat_idx</span><span class="p">,</span> <span class="n">lon_idx</span><span class="p">]</span>

    <span class="c1"># Otherwise, search within a neighbourhood</span>
	<span class="n">lat_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span>
		<span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">lat_idx</span> <span class="o">-</span> <span class="n">max_search_radius</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lats</span><span class="p">),</span> <span class="n">lat_idx</span> <span class="o">+</span> <span class="n">max_search_radius</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
	<span class="p">)</span>
	<span class="n">lon_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span>
		<span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">lon_idx</span> <span class="o">-</span> <span class="n">max_search_radius</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lons</span><span class="p">),</span> <span class="n">lon_idx</span> <span class="o">+</span> <span class="n">max_search_radius</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
	<span class="p">)</span>

	<span class="c1"># Set minimum distance starting point.</span>
	<span class="n">min_dist</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
	<span class="n">best_slice</span> <span class="o">=</span> <span class="kc">None</span>

	<span class="c1"># Loop through longitude and latitude range.</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">lat_range</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">lon_range</span><span class="p">:</span>
			<span class="c1"># Check if data is masked or NaN at this new point.</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">is_masked</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]):</span>
				<span class="c1"># If satisifed, calculated distance between target and valid point.</span>
				<span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">lats</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">target_lat</span><span class="p">,</span> <span class="n">lons</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">target_lon</span><span class="p">)</span>

				<span class="c1"># If the grid point is closer, save this point.</span>
				<span class="k">if</span> <span class="n">dist</span> <span class="o">&lt;</span> <span class="n">min_dist</span><span class="p">:</span>
					<span class="n">min_dist</span> <span class="o">=</span> <span class="n">dist</span>
					<span class="n">best_slice</span> <span class="o">=</span> <span class="n">cube</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>

	<span class="c1"># Only return if there is a valid grid point.</span>
	<span class="k">if</span> <span class="n">best_slice</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">best_slice</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No valid grid point found near the target location.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="master.plot_location_series" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">plot_location_series</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot_location_series</span><span class="p">(</span><span class="n">cubes</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">location_name</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">obs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Plot time series from multiple Iris cubes at the grid point nearest to a named location.</p>
<p>The function uses geocoding (via Nominatim) to resolve a place name into
latitude/longitude, finds the nearest valid grid point in each cube,
extracts the corresponding time series, and plots them together. An
optional set of observational data can also be plotted for comparison.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cubes</code>
            </td>
            <td>
                  <code>list of iris.cube.Cube</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of Iris cubes, each with dimensions including time, latitude, and longitude.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Title for the plot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>labels</code>
            </td>
            <td>
                  <code>list of str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labels for each cube's plotted time series, one per cube.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>location_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Place name to resolve to coordinates via geopy's Nominatim service.
(Requires internet access.)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unit</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for the y-axis (e.g., 'Temperature (K)', 'Precipitation (mm/day)').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fname</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path (including filename) where the figure will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obs</code>
            </td>
            <td>
                  <code>tuple of (array_like, array_like)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Observational data to plot as <code>(times, values)</code>.
- <code>obs[0]</code> : sequence of datetime-like values for the x-axis.
- <code>obs[1]</code> : sequence of numerical values for the y-axis.
Default is None (no observations plotted).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>success</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns <code>True</code> after successfully creating and saving the plot.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the <code>location_name</code> cannot be resolved to coordinates.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If no valid grid point is found near the resolved location in a cube.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>Location lookup uses OpenStreetMap's Nominatim service. Ensure network
  access is available when running this function.</li>
<li>Grid point selection relies on :func:<code>find_nearest_grid_point</code>.</li>
<li>All time series are plotted on the same axis with a common y-label (<code>unit</code>).</li>
<li>Observations, if provided, are added as an additional line labelled
  "Observations".</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>master.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_location_series</span><span class="p">(</span><span class="n">cubes</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">location_name</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">obs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot time series from multiple Iris cubes at the grid point nearest to a named location.</span>

<span class="sd">    The function uses geocoding (via Nominatim) to resolve a place name into</span>
<span class="sd">    latitude/longitude, finds the nearest valid grid point in each cube,</span>
<span class="sd">    extracts the corresponding time series, and plots them together. An</span>
<span class="sd">    optional set of observational data can also be plotted for comparison.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cubes : list of iris.cube.Cube</span>
<span class="sd">        List of Iris cubes, each with dimensions including time, latitude, and longitude.</span>
<span class="sd">    title : str</span>
<span class="sd">        Title for the plot.</span>
<span class="sd">    labels : list of str</span>
<span class="sd">        Labels for each cube&#39;s plotted time series, one per cube.</span>
<span class="sd">    location_name : str</span>
<span class="sd">        Place name to resolve to coordinates via geopy&#39;s Nominatim service.</span>
<span class="sd">        (Requires internet access.)</span>
<span class="sd">    unit : str</span>
<span class="sd">        Label for the y-axis (e.g., &#39;Temperature (K)&#39;, &#39;Precipitation (mm/day)&#39;).</span>
<span class="sd">    fname : str</span>
<span class="sd">        Path (including filename) where the figure will be saved.</span>
<span class="sd">    obs : tuple of (array_like, array_like), optional</span>
<span class="sd">        Observational data to plot as ``(times, values)``.</span>
<span class="sd">        - ``obs[0]`` : sequence of datetime-like values for the x-axis.</span>
<span class="sd">        - ``obs[1]`` : sequence of numerical values for the y-axis.</span>
<span class="sd">        Default is None (no observations plotted).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    success : bool</span>
<span class="sd">        Returns ``True`` after successfully creating and saving the plot.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    Exception</span>
<span class="sd">        If the `location_name` cannot be resolved to coordinates.</span>
<span class="sd">    ValueError</span>
<span class="sd">        If no valid grid point is found near the resolved location in a cube.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - Location lookup uses OpenStreetMap&#39;s Nominatim service. Ensure network</span>
<span class="sd">      access is available when running this function.</span>
<span class="sd">    - Grid point selection relies on :func:`find_nearest_grid_point`.</span>
<span class="sd">    - All time series are plotted on the same axis with a common y-label (`unit`).</span>
<span class="sd">    - Observations, if provided, are added as an additional line labelled</span>
<span class="sd">      &quot;Observations&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
	<span class="c1"># Determine number of rows.</span>
	<span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cubes</span><span class="p">)</span>

	<span class="c1"># Create a geolocator object with a user agent (can be any name)</span>
	<span class="n">geolocator</span> <span class="o">=</span> <span class="n">Nominatim</span><span class="p">(</span><span class="n">user_agent</span><span class="o">=</span><span class="s2">&quot;cocathasaigh&quot;</span><span class="p">)</span>

	<span class="c1"># Enter place name</span>
	<span class="n">location</span> <span class="o">=</span> <span class="n">geolocator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">location_name</span><span class="p">)</span>

	<span class="c1"># Check if location was found.</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">location</span><span class="p">:</span>
		<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Location not found.&quot;</span><span class="p">)</span>

	<span class="c1"># Loop through datasets.</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
		<span class="c1"># Retrieve cube point closet to location.</span>
		<span class="n">nearest_cube_point</span> <span class="o">=</span> <span class="n">find_nearest_grid_point</span><span class="p">(</span>
			<span class="n">cube</span><span class="o">=</span><span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> 
			<span class="n">target_lat</span><span class="o">=</span><span class="n">location</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> 
			<span class="n">target_lon</span><span class="o">=</span><span class="n">location</span><span class="o">.</span><span class="n">longitude</span>
		<span class="p">)</span>

		<span class="c1"># Plot point.</span>
		<span class="n">iplt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nearest_cube_point</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

	<span class="c1"># Deal with x-axis ticks.</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>

	<span class="c1"># Set axis label.</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>

	<span class="c1"># Add observations.</span>
	<span class="k">if</span> <span class="n">obs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">obs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Observations&quot;</span><span class="p">)</span>

	<span class="c1"># Add title.</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">location_name</span><span class="p">),</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

	<span class="c1"># Add legend.</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

	<span class="c1"># Add grid.</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

	<span class="c1"># Save result.</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

	<span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="master.rainfall_cmap" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">rainfall_cmap</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">rainfall_cmap</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Construct a custom colormap and contour levels for rainfall visualisation.</p>
<p>The function defines a sequence of precipitation thresholds (in mm)
and a corresponding set of RGB colors. A <code>ListedColormap</code> is built
and returned together with the contour levels.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>cmap</code></td>            <td>
                  <code><span title="matplotlib.colors.ListedColormap">ListedColormap</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colormap for rainfall, labelled <code>"precipitation"</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>clevs</code></td>            <td>
                  <code>list of float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contour levels (mm) to be used with the colormap.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the number of contour levels and colors are inconsistent.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>Thresholds (<code>clevs</code>) include:
  [0, 0.1, 1, 2.5, 5, 7.5, 10, 15, 20, 25, 30, 40, 50, 70, 100, 150, 200, 250].</li>
<li>Colors progress from white (low values) through cyan, green, yellow,
  orange, red, magenta, purple, gray, to beige (high values).</li>
<li>Designed for use in filled contour plots of accumulated precipitation.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>master.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span>
<span class="normal">993</span>
<span class="normal">994</span>
<span class="normal">995</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rainfall_cmap</span><span class="p">():</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Construct a custom colormap and contour levels for rainfall visualisation.</span>

<span class="sd">    The function defines a sequence of precipitation thresholds (in mm)</span>
<span class="sd">    and a corresponding set of RGB colors. A `ListedColormap` is built</span>
<span class="sd">    and returned together with the contour levels.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cmap : matplotlib.colors.ListedColormap</span>
<span class="sd">        Colormap for rainfall, labelled `&quot;precipitation&quot;`.</span>
<span class="sd">    clevs : list of float</span>
<span class="sd">        Contour levels (mm) to be used with the colormap.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    AssertionError</span>
<span class="sd">        If the number of contour levels and colors are inconsistent.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - Thresholds (`clevs`) include:</span>
<span class="sd">      [0, 0.1, 1, 2.5, 5, 7.5, 10, 15, 20, 25, 30, 40, 50, 70, 100, 150, 200, 250].</span>
<span class="sd">    - Colors progress from white (low values) through cyan, green, yellow,</span>
<span class="sd">      orange, red, magenta, purple, gray, to beige (high values).</span>
<span class="sd">    - Designed for use in filled contour plots of accumulated precipitation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
	<span class="c1"># Draw filled contours.</span>
	<span class="n">clevs</span> <span class="o">=</span> <span class="p">[</span>
		<span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">250</span>
	<span class="p">]</span>

	<span class="c1"># Color map data.</span>
	<span class="n">cmap_data</span> <span class="o">=</span> <span class="p">[</span>
		<span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">0.3137255012989044</span><span class="p">,</span> <span class="mf">0.8156862854957581</span><span class="p">,</span> <span class="mf">0.8156862854957581</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.8784313797950745</span><span class="p">,</span> <span class="mf">0.501960813999176</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.7529411911964417</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">0.501960813999176</span><span class="p">,</span> <span class="mf">0.8784313797950745</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.6274510025978088</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.125490203499794</span><span class="p">,</span> <span class="mf">0.501960813999176</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">0.9411764740943909</span><span class="p">,</span> <span class="mf">0.250980406999588</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">0.501960813999176</span><span class="p">,</span> <span class="mf">0.125490203499794</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">0.250980406999588</span><span class="p">,</span> <span class="mf">0.250980406999588</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">0.125490203499794</span><span class="p">,</span> <span class="mf">0.125490203499794</span><span class="p">,</span> <span class="mf">0.501960813999176</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">0.125490203499794</span><span class="p">,</span> <span class="mf">0.125490203499794</span><span class="p">,</span> <span class="mf">0.125490203499794</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">0.501960813999176</span><span class="p">,</span> <span class="mf">0.501960813999176</span><span class="p">,</span> <span class="mf">0.501960813999176</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">0.8784313797950745</span><span class="p">,</span> <span class="mf">0.8784313797950745</span><span class="p">,</span> <span class="mf">0.8784313797950745</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">0.9333333373069763</span><span class="p">,</span> <span class="mf">0.8313725590705872</span><span class="p">,</span> <span class="mf">0.7372549176216125</span><span class="p">),</span>
		<span class="c1">#(0.8549019694328308, 0.6509804129600525, 0.47058823704719543),</span>
		<span class="c1">#(0.6274510025978088, 0.42352941632270813, 0.23529411852359772),</span>
		<span class="c1">#(0.4000000059604645, 0.20000000298023224, 0.0)</span>
	<span class="p">]</span>

	<span class="c1"># Ensure the number of levels and the number of colours are equal.</span>
	<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">clevs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">cmap_data</span><span class="p">),</span> <span class="s2">&quot;Mismatch between the numbers of colours and numbers of levels&quot;</span>

	<span class="c1"># Create colour map.</span>
	<span class="n">cmap</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span><span class="n">cmap_data</span><span class="p">,</span> <span class="s2">&quot;precipitation&quot;</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">clevs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="master.prate_1hr_cmap" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">prate_1hr_cmap</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">prate_1hr_cmap</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Construct a custom colormap and contour levels for 1-hourly precipitation rate.</p>
<p>The function defines a sequence of precipitation rate thresholds (in mm/hr)
and a corresponding set of RGB colors. A <code>ListedColormap</code> is built and
returned together with the contour levels.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>cmap</code></td>            <td>
                  <code><span title="matplotlib.colors.ListedColormap">ListedColormap</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colormap for precipitation rate, labelled <code>"precipitation_rate"</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>clevs</code></td>            <td>
                  <code>list of float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contour levels (mm/hr) to be used with the colormap.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the number of contour levels and colors are inconsistent.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>Thresholds (<code>clevs</code>) include:
  [0, 0.2, 0.5, 1, 1.5, 2, 4, 10, 25, 50, 100].</li>
<li>Colors progress from white (no rain) through shades of cyan/blue,
  then magenta/orange, to red (intense rainfall).</li>
<li>Designed for use in filled contour plots of precipitation rate fields.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>master.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">prate_1hr_cmap</span><span class="p">():</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Construct a custom colormap and contour levels for 1-hourly precipitation rate.</span>

<span class="sd">    The function defines a sequence of precipitation rate thresholds (in mm/hr)</span>
<span class="sd">    and a corresponding set of RGB colors. A `ListedColormap` is built and</span>
<span class="sd">    returned together with the contour levels.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cmap : matplotlib.colors.ListedColormap</span>
<span class="sd">        Colormap for precipitation rate, labelled `&quot;precipitation_rate&quot;`.</span>
<span class="sd">    clevs : list of float</span>
<span class="sd">        Contour levels (mm/hr) to be used with the colormap.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    AssertionError</span>
<span class="sd">        If the number of contour levels and colors are inconsistent.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - Thresholds (`clevs`) include:</span>
<span class="sd">      [0, 0.2, 0.5, 1, 1.5, 2, 4, 10, 25, 50, 100].</span>
<span class="sd">    - Colors progress from white (no rain) through shades of cyan/blue,</span>
<span class="sd">      then magenta/orange, to red (intense rainfall).</span>
<span class="sd">    - Designed for use in filled contour plots of precipitation rate fields.</span>
<span class="sd">    &quot;&quot;&quot;</span>
	<span class="c1"># Draw filled contours.</span>
	<span class="n">clevs</span> <span class="o">=</span> <span class="p">[</span>
		<span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span>
	<span class="p">]</span>

	<span class="c1"># Color map data.</span>
	<span class="n">cmap_data</span> <span class="o">=</span> <span class="p">[</span>
		<span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.73</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.61</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.49</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
		<span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
	<span class="p">]</span>

	<span class="c1"># Ensure the number of levels and the number of colours are equal.</span>
	<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">clevs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">cmap_data</span><span class="p">),</span> <span class="s2">&quot;Mismatch between the numbers of colours and numbers of levels&quot;</span>

	<span class="c1"># Create colour map.</span>
	<span class="n">cmap</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span><span class="n">cmap_data</span><span class="p">,</span> <span class="s2">&quot;precipitation_rate&quot;</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">clevs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="master.create_param_plot" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_param_plot</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_param_plot</span><span class="p">(</span><span class="n">cubes</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">subtitles</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a grid of filled contour plots for meteorological parameters.</p>
<p>Each subplot corresponds to one Iris cube, displayed on a
Plate Carrée map projection with coastlines and a title.
The colormap and contour levels are chosen automatically
based on the physical unit (e.g., rainfall, temperature, pressure).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cubes</code>
            </td>
            <td>
                  <code>list of list of iris.cube.Cube</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nested list (2D structure) of Iris cubes to plot. Each cube must
contain latitude and longitude coordinates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Overall title for the figure (added as a suptitle).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subtitles</code>
            </td>
            <td>
                  <code>list of list of str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nested list of subplot titles, same shape as <code>cubes</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>levels</code>
            </td>
            <td>
                  <code>list of float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contour levels to use for plotting (may be overridden depending
on the chosen <code>unit</code>).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unit</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Physical unit of the parameter (e.g., 'mm', 'mm/hr', 'K', 'hPa', 'm s-1').
Determines the colormap and normalisation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fname</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path (including filename) where the figure will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code>tuple of float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Figure size in inches, e.g., (width, height).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>success</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns <code>True</code> after successfully creating and saving the plot.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>For rainfall ('mm') and precipitation rate ('mm/hr'), custom
  colormaps are retrieved from <code>rainfall_cmap()</code> and
  <code>prate_1hr_cmap()</code>, respectively, and a <code>BoundaryNorm</code> is applied.</li>
<li>
<p>For other parameters:</p>
</li>
<li>
<p>'K' → <code>RdYlBu_r</code> (temperature)  </p>
</li>
<li>'hPa' → <code>rainbow</code> (pressure; contour levels downsampled by 3)  </li>
<li>'m s-1' → <code>jet</code> (wind speed)  </li>
<li>
<p>everything else → <code>viridis</code>  </p>
</li>
<li>
<p>A horizontal colorbar is added below the subplots with the unit
  as the label.</p>
</li>
<li>Coastlines are drawn with 10m resolution.</li>
<li>If the longitude/latitude coordinates are already 2D (curvilinear grid),
  they are used directly instead of creating a meshgrid.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>master.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_param_plot</span><span class="p">(</span><span class="n">cubes</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">subtitles</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a grid of filled contour plots for meteorological parameters.</span>

<span class="sd">    Each subplot corresponds to one Iris cube, displayed on a</span>
<span class="sd">    Plate Carrée map projection with coastlines and a title.</span>
<span class="sd">    The colormap and contour levels are chosen automatically</span>
<span class="sd">    based on the physical unit (e.g., rainfall, temperature, pressure).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cubes : list of list of iris.cube.Cube</span>
<span class="sd">        Nested list (2D structure) of Iris cubes to plot. Each cube must</span>
<span class="sd">        contain latitude and longitude coordinates.</span>
<span class="sd">    title : str</span>
<span class="sd">        Overall title for the figure (added as a suptitle).</span>
<span class="sd">    subtitles : list of list of str</span>
<span class="sd">        Nested list of subplot titles, same shape as `cubes`.</span>
<span class="sd">    levels : list of float</span>
<span class="sd">        Contour levels to use for plotting (may be overridden depending</span>
<span class="sd">        on the chosen `unit`).</span>
<span class="sd">    unit : str</span>
<span class="sd">        Physical unit of the parameter (e.g., &#39;mm&#39;, &#39;mm/hr&#39;, &#39;K&#39;, &#39;hPa&#39;, &#39;m s-1&#39;).</span>
<span class="sd">        Determines the colormap and normalisation.</span>
<span class="sd">    fname : str</span>
<span class="sd">        Path (including filename) where the figure will be saved.</span>
<span class="sd">    size : tuple of float</span>
<span class="sd">        Figure size in inches, e.g., (width, height).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    success : bool</span>
<span class="sd">        Returns ``True`` after successfully creating and saving the plot.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - For rainfall (&#39;mm&#39;) and precipitation rate (&#39;mm/hr&#39;), custom</span>
<span class="sd">      colormaps are retrieved from `rainfall_cmap()` and</span>
<span class="sd">      `prate_1hr_cmap()`, respectively, and a `BoundaryNorm` is applied.</span>
<span class="sd">    - For other parameters:</span>

<span class="sd">      * &#39;K&#39; → ``RdYlBu_r`` (temperature)  </span>
<span class="sd">      * &#39;hPa&#39; → ``rainbow`` (pressure; contour levels downsampled by 3)  </span>
<span class="sd">      * &#39;m s-1&#39; → ``jet`` (wind speed)  </span>
<span class="sd">      * everything else → ``viridis``  </span>

<span class="sd">    - A horizontal colorbar is added below the subplots with the unit</span>
<span class="sd">      as the label.</span>
<span class="sd">    - Coastlines are drawn with 10m resolution.</span>
<span class="sd">    - If the longitude/latitude coordinates are already 2D (curvilinear grid),</span>
<span class="sd">      they are used directly instead of creating a meshgrid.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Determine number of rows.</span>
	<span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cubes</span><span class="p">)</span>
	<span class="n">ncols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cubes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

	<span class="c1"># Create plot space.</span>
	<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
		<span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()}</span>
	<span class="p">)</span>

	<span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;mm&quot;</span><span class="p">:</span>
		<span class="c1"># Retrieve rainfall levels and create normalisation.</span>
		<span class="c1"># Retrieve colour map.</span>
		<span class="n">cmap</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">rainfall_cmap</span><span class="p">()</span>
		<span class="c1"># Create norm.</span>
		<span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
		<span class="c1"># Add to list.</span>
		<span class="n">cmapping</span> <span class="o">=</span> <span class="p">[</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="p">]</span>
	<span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;mm/hr&quot;</span><span class="p">:</span>
		<span class="c1"># Retrieve rainfall levels and create normalisation.</span>
		<span class="c1"># Retrieve colour map.</span>
		<span class="n">cmap</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">prate_1hr_cmap</span><span class="p">()</span>
		<span class="c1"># Create norm.</span>
		<span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
		<span class="c1"># Add to list.</span>
		<span class="n">cmapping</span> <span class="o">=</span> <span class="p">[</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="p">]</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="c1"># Define colour map for other parameters.</span>
		<span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;K&quot;</span><span class="p">:</span>
			<span class="c1"># Air temperature.</span>
			<span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;RdYlBu_r&quot;</span>
		<span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;hPa&quot;</span><span class="p">:</span>
			<span class="c1"># Air pressure.</span>
			<span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;rainbow&quot;</span>

			<span class="c1"># Cut the number of contourf levels.</span>
			<span class="n">levels</span> <span class="o">=</span> <span class="n">levels</span><span class="p">[::</span><span class="mi">3</span><span class="p">]</span>
		<span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;m s-1&quot;</span><span class="p">:</span>
			<span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;jet&quot;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="c1"># Everything else.</span>
			<span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;viridis&quot;</span>

		<span class="c1"># Add to list.</span>
		<span class="n">cmapping</span> <span class="o">=</span> <span class="p">[</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="p">]</span>

	<span class="c1"># Loop through datasets.</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
		<span class="n">cubes_row</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
			<span class="c1"># Create longitude-latitude meshgrid.</span>
			<span class="n">lon</span> <span class="o">=</span> <span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span>
			<span class="n">lat</span> <span class="o">=</span> <span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span>
			<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>

			<span class="c1"># Check if the grid is rectangular. </span>
			<span class="k">if</span> <span class="n">lon</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="c1"># Generate mesh grid.</span>
				<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="c1"># Get longitude-latitude as x-y.</span>
				<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span>

			<span class="c1"># Get axis for plotting.</span>
			<span class="k">if</span> <span class="n">nrows</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span>
			<span class="k">elif</span> <span class="n">nrows</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
			<span class="k">elif</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>

			<span class="c1"># Add high-resolution coastlines.</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;10m&#39;</span><span class="p">)</span>

			<span class="c1"># Add subplot title.</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">subtitles</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>

			<span class="c1"># Create filled contour plot.</span>
			<span class="n">contourf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
				<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">cmapping</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmapping</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">extend</span><span class="o">=</span><span class="s2">&quot;both&quot;</span> 
			<span class="p">)</span>

	<span class="c1"># Add title.</span>
	<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">title</span><span class="p">),</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

	<span class="c1"># Create colour bar.</span>
	<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
		<span class="n">contourf</span><span class="p">,</span> 
		<span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> 
		<span class="n">aspect</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> 
		<span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span> 
		<span class="n">extend</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> 
		<span class="n">fraction</span><span class="o">=</span><span class="mf">0.02</span>
	<span class="p">)</span>
	<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
	<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

	<span class="c1"># Set size.</span>
	<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

	<span class="c1"># Save file.</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

	<span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="master.create_bias_plot" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_bias_plot</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_bias_plot</span><span class="p">(</span><span class="n">cubes</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">subtitles</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a grid of spatial bias plots with statistical annotations.</p>
<p>Each subplot corresponds to one Iris cube and is displayed on a Plate
Carrée map projection with coastlines and a title. A diverging colormap
is used to highlight positive/negative biases, and summary statistics
are added to each subplot.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cubes</code>
            </td>
            <td>
                  <code>list of list of iris.cube.Cube</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nested list (2D structure) of Iris cubes to plot. Each cube must
contain latitude and longitude coordinates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Overall title for the figure (added as a suptitle).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subtitles</code>
            </td>
            <td>
                  <code>list of list of str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nested list of subplot titles, same shape as <code>cubes</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>levels</code>
            </td>
            <td>
                  <code>list of float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contour levels to use for filled contour plotting.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unit</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Physical unit of the parameter (e.g., 'mm', 'K', 'hPa').
Determines the choice of colormap:</p>
<ul>
<li>"mm" → <code>BrBG</code> (precipitation biases)  </li>
<li>everything else → <code>RdBu_r</code> (diverging red/blue)</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fname</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path (including filename) where the figure will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code>tuple of float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Figure size in inches, e.g., (width, height).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>success</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns <code>True</code> after successfully creating and saving the plot.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>Bias values are expected in the input cubes (e.g., model minus observations).</li>
<li>Each subplot includes anchored statistics (mean absolute error,
  standard deviation, and mean bias) via
  :func:<code>add_statistical_information</code>.</li>
<li>A horizontal colorbar is added below the subplots, labelled with <code>unit</code>.</li>
<li>Coastlines are drawn with 10m resolution.</li>
<li>The function uses :func:<code>iris.plot.contourf</code> (<code>iplt.contourf</code>) for plotting,
  which directly accepts an Iris cube.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>master.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_bias_plot</span><span class="p">(</span><span class="n">cubes</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">subtitles</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a grid of spatial bias plots with statistical annotations.</span>

<span class="sd">    Each subplot corresponds to one Iris cube and is displayed on a Plate</span>
<span class="sd">    Carrée map projection with coastlines and a title. A diverging colormap</span>
<span class="sd">    is used to highlight positive/negative biases, and summary statistics</span>
<span class="sd">    are added to each subplot.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cubes : list of list of iris.cube.Cube</span>
<span class="sd">        Nested list (2D structure) of Iris cubes to plot. Each cube must</span>
<span class="sd">        contain latitude and longitude coordinates.</span>
<span class="sd">    title : str</span>
<span class="sd">        Overall title for the figure (added as a suptitle).</span>
<span class="sd">    subtitles : list of list of str</span>
<span class="sd">        Nested list of subplot titles, same shape as `cubes`.</span>
<span class="sd">    levels : list of float</span>
<span class="sd">        Contour levels to use for filled contour plotting.</span>
<span class="sd">    unit : str</span>
<span class="sd">        Physical unit of the parameter (e.g., &#39;mm&#39;, &#39;K&#39;, &#39;hPa&#39;).</span>
<span class="sd">        Determines the choice of colormap:</span>

<span class="sd">        - &quot;mm&quot; → ``BrBG`` (precipitation biases)  </span>
<span class="sd">        - everything else → ``RdBu_r`` (diverging red/blue)  </span>
<span class="sd">    fname : str</span>
<span class="sd">        Path (including filename) where the figure will be saved.</span>
<span class="sd">    size : tuple of float</span>
<span class="sd">        Figure size in inches, e.g., (width, height).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    success : bool</span>
<span class="sd">        Returns ``True`` after successfully creating and saving the plot.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - Bias values are expected in the input cubes (e.g., model minus observations).</span>
<span class="sd">    - Each subplot includes anchored statistics (mean absolute error,</span>
<span class="sd">      standard deviation, and mean bias) via</span>
<span class="sd">      :func:`add_statistical_information`.</span>
<span class="sd">    - A horizontal colorbar is added below the subplots, labelled with `unit`.</span>
<span class="sd">    - Coastlines are drawn with 10m resolution.</span>
<span class="sd">    - The function uses :func:`iris.plot.contourf` (`iplt.contourf`) for plotting,</span>
<span class="sd">      which directly accepts an Iris cube.</span>
<span class="sd">    &quot;&quot;&quot;</span>
	<span class="c1"># Determine number of rows.</span>
	<span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cubes</span><span class="p">)</span>
	<span class="n">ncols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cubes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

	<span class="c1"># Create plot space.</span>
	<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
		<span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()}</span>
	<span class="p">)</span>

	<span class="c1"># Set colour map.</span>
	<span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;mm&quot;</span><span class="p">:</span>
		<span class="c1"># Precipitation.</span>
		<span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;BrBG&quot;</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="c1"># Everything else:</span>
		<span class="n">cmap</span><span class="o">=</span> <span class="s2">&quot;RdBu_r&quot;</span>

	<span class="c1"># Loop through datasets.</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
		<span class="n">cubes_row</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
			<span class="c1"># # Create longitude-latitude meshgrid.</span>
			<span class="c1"># lon = cubes[i][j].coord(&#39;longitude&#39;).points</span>
			<span class="c1"># lat = cubes[i][j].coord(&#39;latitude&#39;).points</span>
			<span class="c1"># x, y = np.meshgrid(lon, lat)</span>

			<span class="c1"># # Check if the grid is rectangular. </span>
			<span class="c1"># if lon.ndim == 1:</span>
			<span class="c1"># 	# Generate mesh grid.</span>
			<span class="c1"># 	x, y = np.meshgrid(lon, lat)</span>
			<span class="c1"># else:</span>
			<span class="c1"># 	# Get longitude-latitude as x-y.</span>
			<span class="c1"># 	x, y = lon, lat</span>

			<span class="c1"># Get axis for plotting.</span>
			<span class="k">if</span> <span class="n">nrows</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span>
			<span class="k">elif</span> <span class="n">nrows</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
			<span class="k">elif</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>

			<span class="c1"># Add high-resolution coastlines.</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;10m&#39;</span><span class="p">)</span>

			<span class="c1"># Add subplot title.</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">subtitles</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>

			<span class="c1"># Create filled contour plot.</span>
			<span class="n">contourf</span> <span class="o">=</span> <span class="n">iplt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
				<span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">ax</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s2">&quot;both&quot;</span> 
			<span class="p">)</span>

			<span class="c1"># Add statistical information.</span>
			<span class="n">add_statistical_information</span><span class="p">(</span><span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>

	<span class="c1"># Add title.</span>
	<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">title</span><span class="p">),</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

	<span class="c1"># Create colour bar.</span>
	<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
		<span class="n">contourf</span><span class="p">,</span> 
		<span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> 
		<span class="n">aspect</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> 
		<span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span> 
		<span class="n">extend</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> 
		<span class="n">fraction</span><span class="o">=</span><span class="mf">0.02</span>
	<span class="p">)</span>
	<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
	<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

	<span class="c1"># Set size.</span>
	<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

	<span class="c1"># Save file.</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

	<span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="master.create_param_ani" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_param_ani</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_param_ani</span><span class="p">(</span><span class="n">cubes</span><span class="p">,</span> <span class="n">focus_period</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">subtitles</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">interval</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create an animated sequence of meteorological parameter maps.</p>
<p>Each subplot corresponds to one Iris cube, displayed on a Plate
Carrée map projection with coastlines. The function extracts data for
a given focus period, creates filled contour maps for each timestep,
and generates both individual frame images (PNG) and an MP4 animation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cubes</code>
            </td>
            <td>
                  <code>list of list of iris.cube.Cube</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nested list (2D structure) of Iris cubes to animate. Each cube
must contain dimensions including <code>time</code>, <code>latitude</code>, and
<code>longitude</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>focus_period</code>
            </td>
            <td>
                  <code><span title="iris.Constraint">Constraint</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Constraint selecting the time range to animate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Overall title for the animation. The current date is appended
automatically in each frame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subtitles</code>
            </td>
            <td>
                  <code>list of list of str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nested list of subplot titles, same shape as <code>cubes</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unit</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unit of the parameter being plotted. Determines color mapping:</p>
<ul>
<li>"mm" → rainfall colormap via :func:<code>rainfall_cmap</code></li>
<li>"mm/hr" → precipitation rate colormap via :func:<code>prate_1hr_cmap</code></li>
<li>"K" → <code>RdYlBu_r</code></li>
<li>"hPa" → <code>rainbow</code> (pressure, with optional contours)</li>
<li>everything else → <code>viridis</code></li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>folder</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the output folder. Individual frames (PNG) and the MP4
animation will be saved here. The folder is created if it does
not exist.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code>tuple of float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Figure size in inches, e.g., (width, height).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Delay between frames in milliseconds (passed to
:class:<code>matplotlib.animation.FuncAnimation</code>).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>success</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns <code>True</code> after successfully creating and saving the animation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>Each frame includes a title showing the simulation title and the
  current datetime.</li>
<li>If <code>"Reference: ERA5"</code> is in the title, only every fourth frame
  is saved as PNG; otherwise, all frames are saved.</li>
<li>Colorbars are added once at the bottom of the figure, labelled with <code>unit</code>.</li>
<li>For pressure fields (<code>unit="hPa"</code>), contour lines with labels are
  added on top of the filled contours.</li>
<li>Progress is tracked with a :class:<code>tqdm</code> progress bar.</li>
<li>The final MP4 is saved as <code>&lt;folder&gt;/&lt;foldername&gt;_ani.mp4</code> where
  <code>foldername</code> is the basename of <code>folder</code>.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>master.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_param_ani</span><span class="p">(</span><span class="n">cubes</span><span class="p">,</span> <span class="n">focus_period</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">subtitles</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">interval</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create an animated sequence of meteorological parameter maps.</span>

<span class="sd">    Each subplot corresponds to one Iris cube, displayed on a Plate</span>
<span class="sd">    Carrée map projection with coastlines. The function extracts data for</span>
<span class="sd">    a given focus period, creates filled contour maps for each timestep,</span>
<span class="sd">    and generates both individual frame images (PNG) and an MP4 animation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cubes : list of list of iris.cube.Cube</span>
<span class="sd">        Nested list (2D structure) of Iris cubes to animate. Each cube</span>
<span class="sd">        must contain dimensions including ``time``, ``latitude``, and</span>
<span class="sd">        ``longitude``.</span>
<span class="sd">    focus_period : iris.Constraint</span>
<span class="sd">        Constraint selecting the time range to animate.</span>
<span class="sd">    title : str</span>
<span class="sd">        Overall title for the animation. The current date is appended</span>
<span class="sd">        automatically in each frame.</span>
<span class="sd">    subtitles : list of list of str</span>
<span class="sd">        Nested list of subplot titles, same shape as `cubes`.</span>
<span class="sd">    unit : str</span>
<span class="sd">        Unit of the parameter being plotted. Determines color mapping:</span>

<span class="sd">        - &quot;mm&quot; → rainfall colormap via :func:`rainfall_cmap`</span>
<span class="sd">        - &quot;mm/hr&quot; → precipitation rate colormap via :func:`prate_1hr_cmap`</span>
<span class="sd">        - &quot;K&quot; → ``RdYlBu_r``</span>
<span class="sd">        - &quot;hPa&quot; → ``rainbow`` (pressure, with optional contours)</span>
<span class="sd">        - everything else → ``viridis``</span>
<span class="sd">    folder : str</span>
<span class="sd">        Path to the output folder. Individual frames (PNG) and the MP4</span>
<span class="sd">        animation will be saved here. The folder is created if it does</span>
<span class="sd">        not exist.</span>
<span class="sd">    size : tuple of float</span>
<span class="sd">        Figure size in inches, e.g., (width, height).</span>
<span class="sd">    interval : int</span>
<span class="sd">        Delay between frames in milliseconds (passed to</span>
<span class="sd">        :class:`matplotlib.animation.FuncAnimation`).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    success : bool</span>
<span class="sd">        Returns ``True`` after successfully creating and saving the animation.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - Each frame includes a title showing the simulation title and the</span>
<span class="sd">      current datetime.</span>
<span class="sd">    - If ``&quot;Reference: ERA5&quot;`` is in the title, only every fourth frame</span>
<span class="sd">      is saved as PNG; otherwise, all frames are saved.</span>
<span class="sd">    - Colorbars are added once at the bottom of the figure, labelled with `unit`.</span>
<span class="sd">    - For pressure fields (`unit=&quot;hPa&quot;`), contour lines with labels are</span>
<span class="sd">      added on top of the filled contours.</span>
<span class="sd">    - Progress is tracked with a :class:`tqdm` progress bar.</span>
<span class="sd">    - The final MP4 is saved as ``&lt;folder&gt;/&lt;foldername&gt;_ani.mp4`` where</span>
<span class="sd">      ``foldername`` is the basename of `folder`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
	<span class="c1"># Determine number of rows.</span>
	<span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cubes</span><span class="p">)</span>
	<span class="n">ncols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cubes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

	<span class="c1"># Create plot space.</span>
	<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
		<span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()}</span>
	<span class="p">)</span>

	<span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;mm&quot;</span><span class="p">:</span>
		<span class="c1"># Retrieve rainfall levels and create normalisation.</span>
		<span class="c1"># Retrieve colour map.</span>
		<span class="n">cmap</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">rainfall_cmap</span><span class="p">()</span>
		<span class="c1"># Create norm.</span>
		<span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
		<span class="c1"># Add to list.</span>
		<span class="n">cmapping</span> <span class="o">=</span> <span class="p">[</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="p">]</span>
	<span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;mm/hr&quot;</span><span class="p">:</span>
		<span class="c1"># Retrieve rainfall levels and create normalisation.</span>
		<span class="c1"># Retrieve colour map.</span>
		<span class="n">cmap</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">prate_1hr_cmap</span><span class="p">()</span>
		<span class="c1"># Create norm.</span>
		<span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
		<span class="c1"># Add to list.</span>
		<span class="n">cmapping</span> <span class="o">=</span> <span class="p">[</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="p">]</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="c1"># Define levels based on reference dataset.</span>
		<span class="c1"># Get maximum.</span>
		<span class="n">min_param</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span>
			<span class="n">cubes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">collapsed</span><span class="p">(</span>
				<span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">],</span> <span class="n">iris</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">MIN</span>
			<span class="p">)</span><span class="o">.</span><span class="n">data</span>
		<span class="p">)</span>
		<span class="c1"># Get minimum.</span>
		<span class="n">max_param</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span>
			<span class="n">cubes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">collapsed</span><span class="p">(</span>
				<span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">],</span> <span class="n">iris</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">MAX</span>
			<span class="p">)</span><span class="o">.</span><span class="n">data</span>
		<span class="p">)</span>
		<span class="c1"># Convert to integers.</span>
		<span class="n">min_param</span><span class="p">,</span> <span class="n">max_param</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">min_param</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">max_param</span><span class="p">)</span>
		<span class="c1"># Create levels.</span>
		<span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span>
			<span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">min_param</span><span class="p">,</span> <span class="n">max_param</span><span class="p">,</span> <span class="p">(</span><span class="n">max_param</span> <span class="o">-</span> <span class="n">min_param</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
		<span class="p">)</span>

		<span class="c1"># Define colour map for other parameters.</span>
		<span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;K&quot;</span><span class="p">:</span>
			<span class="c1"># Air temperature.</span>
			<span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;RdYlBu_r&quot;</span>
		<span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;hPa&quot;</span><span class="p">:</span>
			<span class="c1"># Air pressure.</span>
			<span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;rainbow&quot;</span>

			<span class="c1"># Cut the number of contourf levels.</span>
			<span class="n">levels</span> <span class="o">=</span> <span class="n">levels</span><span class="p">[::</span><span class="mi">3</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="c1"># Everything else.</span>
			<span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;viridis&quot;</span>

		<span class="c1"># Add to list.</span>
		<span class="n">cmapping</span> <span class="o">=</span> <span class="p">[</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="p">]</span>

	<span class="c1"># Loop through datasets.</span>
	<span class="n">contourfs</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="n">new_cubes</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
		<span class="n">cubes_row</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
			<span class="c1"># Create longitude-latitude meshgrid.</span>
			<span class="n">lon</span> <span class="o">=</span> <span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span>
			<span class="n">lat</span> <span class="o">=</span> <span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span>
			<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>

			<span class="c1"># Check if the grid is rectangular. </span>
			<span class="k">if</span> <span class="n">lon</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="c1"># Generate mesh grid.</span>
				<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="c1"># Get longitude-latitude as x-y.</span>
				<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span>

			<span class="c1"># Get axis for plotting.</span>
			<span class="k">if</span> <span class="n">nrows</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span>
			<span class="k">elif</span> <span class="n">nrows</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
			<span class="k">elif</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>

			<span class="c1"># Add high-resolution coastlines.</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;10m&#39;</span><span class="p">)</span>

			<span class="c1"># Add subplot title.</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">subtitles</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>

			<span class="c1"># Extract time period.</span>
			<span class="n">cube</span> <span class="o">=</span> <span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">focus_period</span><span class="p">)</span>
			<span class="n">cubes_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cube</span><span class="p">)</span>

			<span class="c1"># Create inital contour plot.</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cmapping</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
				<span class="c1"># Rainfall.</span>
				<span class="n">contourf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
					<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cube</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> 
					<span class="n">levels</span><span class="o">=</span><span class="n">cmapping</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmapping</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">norm</span><span class="o">=</span><span class="n">cmapping</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> 
					<span class="n">extend</span><span class="o">=</span><span class="s2">&quot;max&quot;</span>
				<span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="c1"># Other parameters.</span>
				<span class="n">contourf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
					<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cube</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> 
					<span class="n">levels</span><span class="o">=</span><span class="n">cmapping</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmapping</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
				<span class="p">)</span>
			<span class="n">contourfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contourf</span><span class="p">)</span>

		<span class="c1"># Add row of time constrained cubes.</span>
		<span class="n">new_cubes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cubes_row</span><span class="p">)</span>

	<span class="c1"># Redefine cubes variable.</span>
	<span class="n">cubes</span> <span class="o">=</span> <span class="n">new_cubes</span>

	<span class="c1"># Update function for animation.</span>
	<span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">cubes</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">pbar</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">cmapping</span><span class="p">):</span>
		<span class="c1"># Determine number of rows.</span>
		<span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cubes</span><span class="p">)</span>
		<span class="n">ncols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cubes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

		<span class="c1"># Remove plots.</span>
		<span class="c1"># Define global.</span>
		<span class="k">global</span> <span class="n">contours</span>
		<span class="k">global</span> <span class="n">contourfs</span>
		<span class="c1"># Try removal.</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">contourf</span> <span class="ow">in</span> <span class="n">contourfs</span><span class="p">:</span>
				<span class="n">contourf</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
			<span class="k">for</span> <span class="n">contour</span> <span class="ow">in</span> <span class="n">contours</span><span class="p">:</span>
				<span class="n">contour</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">pass</span>

		<span class="c1"># Determine date.</span>
		<span class="n">cube_time</span> <span class="o">=</span> <span class="n">cubes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
		<span class="n">date</span> <span class="o">=</span> <span class="n">cube_time</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">cube_time</span><span class="o">.</span><span class="n">points</span><span class="p">)[</span><span class="n">frame</span><span class="p">]</span>

		<span class="c1"># Loop through cubes.</span>
		<span class="n">contours</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">contourfs</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
			<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
				<span class="c1"># Create longitude-latitude meshgrid.</span>
				<span class="n">lon</span> <span class="o">=</span> <span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span>
				<span class="n">lat</span> <span class="o">=</span> <span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span>

				<span class="c1"># Check if the grid is rectangular. </span>
				<span class="k">if</span> <span class="n">lon</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
					<span class="c1"># Generate mesh grid.</span>
					<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="c1"># Get longitude-latitude as x-y.</span>
					<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span>

				<span class="c1"># Get relevant cube.</span>
				<span class="n">cube_data</span> <span class="o">=</span> <span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">frame</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

				<span class="c1"># Get axis for plotting.</span>
				<span class="k">if</span> <span class="n">nrows</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
					<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span>
				<span class="k">elif</span> <span class="n">nrows</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
					<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
				<span class="k">elif</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
					<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>

				<span class="c1"># Create inital contour plot.</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cmapping</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
					<span class="c1"># Rainfall.</span>
					<span class="n">contourf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
						<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cube_data</span><span class="p">,</span> 
						<span class="n">levels</span><span class="o">=</span><span class="n">cmapping</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmapping</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">norm</span><span class="o">=</span><span class="n">cmapping</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> 
						<span class="n">extend</span><span class="o">=</span><span class="s2">&quot;max&quot;</span>
					<span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="c1"># Every other parameter.</span>
					<span class="n">contourf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
						<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cube_data</span><span class="p">,</span> 
						<span class="n">levels</span><span class="o">=</span><span class="n">cmapping</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmapping</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">extend</span><span class="o">=</span><span class="s2">&quot;both&quot;</span>
					<span class="p">)</span>

					<span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;hPa&quot;</span><span class="p">:</span>
						<span class="c1"># Plot contour lines if looking at air pressure.</span>
						<span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span>
							<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cube_data</span><span class="p">,</span> 
							<span class="n">levels</span><span class="o">=</span><span class="n">cmapping</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span>
						<span class="p">)</span>

						<span class="c1"># Add labels.</span>
						<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

						<span class="c1"># Append to list.</span>
						<span class="n">contours</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contour</span><span class="p">)</span>
				<span class="n">contourfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contourf</span><span class="p">)</span>

		<span class="c1"># Add title.</span>
		<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span>
			<span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n</span><span class="s2">Date: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-%m-%Y %H:%M&#39;</span><span class="p">)),</span> 
			<span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span>
		<span class="p">)</span>

		<span class="c1"># Save frame.</span>
		<span class="n">fname</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">.png&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
			<span class="n">folder</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">%H%M&#39;</span><span class="p">)</span>
		<span class="p">)</span>

		<span class="k">if</span> <span class="ow">not</span> <span class="s2">&quot;Reference: ERA5&quot;</span> <span class="ow">in</span> <span class="n">title</span><span class="p">:</span>
			<span class="c1"># Save every frame is gridded dataset.</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">fname</span><span class="p">))</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="c1"># Save every fourth frame if ERA5.</span>
			<span class="k">if</span> <span class="n">frame</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">fname</span><span class="p">))</span>

		<span class="c1"># Update progress bar.</span>
		<span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

		<span class="k">return</span> <span class="n">contourfs</span>

	<span class="c1"># Initialize tqdm progress bar</span>
	<span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span>
		<span class="n">total</span><span class="o">=</span><span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Animating parameter plots&quot;</span>
	<span class="p">)</span>

	<span class="c1"># Create animation.</span>
	<span class="n">ani</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span>
		<span class="n">fig</span><span class="p">,</span> 
		<span class="n">update</span><span class="p">,</span> 
		<span class="n">frames</span><span class="o">=</span><span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
		<span class="n">fargs</span><span class="o">=</span><span class="p">(</span><span class="n">cubes</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">pbar</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">cmapping</span><span class="p">),</span>
		<span class="n">interval</span><span class="o">=</span><span class="n">interval</span>
	<span class="p">)</span>

	<span class="c1"># Create colour bar.</span>
	<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
		<span class="n">contourf</span><span class="p">,</span> 
		<span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> 
		<span class="n">aspect</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> 
		<span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span> 
		<span class="n">extend</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> 
		<span class="n">fraction</span><span class="o">=</span><span class="mf">0.02</span>
	<span class="p">)</span>
	<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
	<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

	<span class="c1"># Set size.</span>
	<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

	<span class="c1"># Check if folder exists.</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">folder</span><span class="p">):</span>
		<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>

	<span class="c1"># Save file as MP4.</span>
	<span class="n">fname</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_ani.mp4&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
	<span class="n">ani</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">fname</span><span class="p">))</span>

	<span class="c1"># Close progress bar.</span>
	<span class="n">pbar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

	<span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="master.create_bias_ani" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_bias_ani</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_bias_ani</span><span class="p">(</span><span class="n">cubes</span><span class="p">,</span> <span class="n">focus_period</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">subtitles</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">stat_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create an animated sequence of bias plots.</p>
<p>Each subplot corresponds to one Iris cube, displayed on a Plate
Carrée map projection with coastlines. The function extracts data
for a given focus period, creates filled contour maps for each timestep,
and generates both individual frame images (PNG) and an MP4 animation.
Optional summary statistics can be added to each subplot.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cubes</code>
            </td>
            <td>
                  <code>list of list of iris.cube.Cube</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nested list (2D structure) of Iris cubes to animate. Each cube must
contain dimensions including <code>time</code>, <code>latitude</code>, and <code>longitude</code>.
The data are expected to represent model–observation differences
(biases).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>focus_period</code>
            </td>
            <td>
                  <code><span title="iris.Constraint">Constraint</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Constraint selecting the time range to animate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Overall title for the animation. The current date is appended
automatically in each frame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subtitles</code>
            </td>
            <td>
                  <code>list of list of str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nested list of subplot titles, same shape as <code>cubes</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>levels</code>
            </td>
            <td>
                  <code>list of float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contour levels for bias plotting.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unit</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unit of the variable (e.g., "mm", "mm/hr", "K"). Determines
the colormap:</p>
<ul>
<li>"mm" or "mm/hr" → <code>BrBG</code> (precipitation biases)</li>
<li>everything else → <code>RdBu_r</code> (diverging red/blue)</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>folder</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the output folder. Individual frames (PNG) and the MP4
animation will be saved here. The folder is created if it does
not exist.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code>tuple of float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Figure size in inches, e.g., (width, height).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Delay between frames in milliseconds (passed to
:class:<code>matplotlib.animation.FuncAnimation</code>).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stat_info</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True (default), statistical summaries (mean absolute value,
standard deviation, mean bias) are added to each subplot using
:func:<code>add_statistical_information</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>success</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns <code>True</code> after successfully creating and saving the animation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>Each frame includes a title showing the simulation title and the
  current datetime.</li>
<li>If <code>"Reference: ERA5"</code> is in the title, only every fourth frame
  is saved as PNG; otherwise, all frames are saved.</li>
<li>A horizontal colorbar is added below the subplots, labelled with <code>unit</code>.</li>
<li>Coastlines are drawn with 10m resolution.</li>
<li>Progress is tracked with a :class:<code>tqdm</code> progress bar.</li>
<li>The final MP4 is saved as <code>&lt;folder&gt;/&lt;foldername&gt;_ani.mp4</code> where
  <code>foldername</code> is the basename of <code>folder</code>.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>master.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_bias_ani</span><span class="p">(</span><span class="n">cubes</span><span class="p">,</span> <span class="n">focus_period</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">subtitles</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">stat_info</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create an animated sequence of bias plots.</span>

<span class="sd">    Each subplot corresponds to one Iris cube, displayed on a Plate</span>
<span class="sd">    Carrée map projection with coastlines. The function extracts data</span>
<span class="sd">    for a given focus period, creates filled contour maps for each timestep,</span>
<span class="sd">    and generates both individual frame images (PNG) and an MP4 animation.</span>
<span class="sd">    Optional summary statistics can be added to each subplot.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cubes : list of list of iris.cube.Cube</span>
<span class="sd">        Nested list (2D structure) of Iris cubes to animate. Each cube must</span>
<span class="sd">        contain dimensions including ``time``, ``latitude``, and ``longitude``.</span>
<span class="sd">        The data are expected to represent model–observation differences</span>
<span class="sd">        (biases).</span>
<span class="sd">    focus_period : iris.Constraint</span>
<span class="sd">        Constraint selecting the time range to animate.</span>
<span class="sd">    title : str</span>
<span class="sd">        Overall title for the animation. The current date is appended</span>
<span class="sd">        automatically in each frame.</span>
<span class="sd">    subtitles : list of list of str</span>
<span class="sd">        Nested list of subplot titles, same shape as `cubes`.</span>
<span class="sd">    levels : list of float</span>
<span class="sd">        Contour levels for bias plotting.</span>
<span class="sd">    unit : str</span>
<span class="sd">        Unit of the variable (e.g., &quot;mm&quot;, &quot;mm/hr&quot;, &quot;K&quot;). Determines</span>
<span class="sd">        the colormap:</span>

<span class="sd">        - &quot;mm&quot; or &quot;mm/hr&quot; → ``BrBG`` (precipitation biases)</span>
<span class="sd">        - everything else → ``RdBu_r`` (diverging red/blue)</span>
<span class="sd">    folder : str</span>
<span class="sd">        Path to the output folder. Individual frames (PNG) and the MP4</span>
<span class="sd">        animation will be saved here. The folder is created if it does</span>
<span class="sd">        not exist.</span>
<span class="sd">    size : tuple of float</span>
<span class="sd">        Figure size in inches, e.g., (width, height).</span>
<span class="sd">    interval : int</span>
<span class="sd">        Delay between frames in milliseconds (passed to</span>
<span class="sd">        :class:`matplotlib.animation.FuncAnimation`).</span>
<span class="sd">    stat_info : bool, optional</span>
<span class="sd">        If True (default), statistical summaries (mean absolute value,</span>
<span class="sd">        standard deviation, mean bias) are added to each subplot using</span>
<span class="sd">        :func:`add_statistical_information`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    success : bool</span>
<span class="sd">        Returns ``True`` after successfully creating and saving the animation.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - Each frame includes a title showing the simulation title and the</span>
<span class="sd">      current datetime.</span>
<span class="sd">    - If ``&quot;Reference: ERA5&quot;`` is in the title, only every fourth frame</span>
<span class="sd">      is saved as PNG; otherwise, all frames are saved.</span>
<span class="sd">    - A horizontal colorbar is added below the subplots, labelled with `unit`.</span>
<span class="sd">    - Coastlines are drawn with 10m resolution.</span>
<span class="sd">    - Progress is tracked with a :class:`tqdm` progress bar.</span>
<span class="sd">    - The final MP4 is saved as ``&lt;folder&gt;/&lt;foldername&gt;_ani.mp4`` where</span>
<span class="sd">      ``foldername`` is the basename of `folder`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
	<span class="c1"># Determine number of rows.</span>
	<span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cubes</span><span class="p">)</span>
	<span class="n">ncols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cubes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

	<span class="c1"># Create plot space.</span>
	<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
		<span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()}</span>
	<span class="p">)</span>

	<span class="c1"># Set colour map.</span>
	<span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;mm&quot;</span> <span class="ow">or</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;mm/hr&quot;</span><span class="p">:</span>
		<span class="c1"># Precipitation.</span>
		<span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;BrBG&quot;</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="c1"># Everything else:</span>
		<span class="n">cmap</span><span class="o">=</span> <span class="s2">&quot;RdBu_r&quot;</span>

	<span class="c1"># Loop through datasets.</span>
	<span class="n">contourfs</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="n">new_cubes</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
		<span class="n">cubes_row</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
			<span class="c1"># Create longitude-latitude meshgrid.</span>
			<span class="n">lon</span> <span class="o">=</span> <span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span>
			<span class="n">lat</span> <span class="o">=</span> <span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span>
			<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>

			<span class="c1"># Check if the grid is rectangular. </span>
			<span class="k">if</span> <span class="n">lon</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="c1"># Generate mesh grid.</span>
				<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="c1"># Get longitude-latitude as x-y.</span>
				<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span>

			<span class="c1"># Get axis for plotting.</span>
			<span class="k">if</span> <span class="n">nrows</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span>
			<span class="k">elif</span> <span class="n">nrows</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
			<span class="k">elif</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>

			<span class="c1"># Add high-resolution coastlines.</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;10m&#39;</span><span class="p">)</span>

			<span class="c1"># Add subplot title.</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">subtitles</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>

			<span class="c1"># Extract time period.</span>
			<span class="n">cube</span> <span class="o">=</span> <span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">focus_period</span><span class="p">)</span>
			<span class="n">cubes_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cube</span><span class="p">)</span>

			<span class="c1"># Create inital contour plot.</span>
			<span class="n">contourf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
				<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cube</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s2">&quot;both&quot;</span>
			<span class="p">)</span>
			<span class="n">contourfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contourf</span><span class="p">)</span>

			<span class="c1"># Add statistical information.</span>
			<span class="k">if</span> <span class="n">stat_info</span><span class="p">:</span>
				<span class="n">add_statistical_information</span><span class="p">(</span><span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>

		<span class="c1"># Add row of time constrained cubes.</span>
		<span class="n">new_cubes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cubes_row</span><span class="p">)</span>

	<span class="c1"># Redefine cubes variable.</span>
	<span class="n">cubes</span> <span class="o">=</span> <span class="n">new_cubes</span>

	<span class="c1"># Update function for animation.</span>
	<span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">cubes</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">pbar</span><span class="p">,</span> <span class="n">folder</span><span class="p">):</span>
		<span class="c1"># Determine number of rows.</span>
		<span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cubes</span><span class="p">)</span>
		<span class="n">ncols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cubes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

		<span class="c1"># Remove plots.</span>
		<span class="c1"># Define global.</span>
		<span class="k">global</span> <span class="n">contourfs</span>
		<span class="c1"># Try removal.</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">contourf</span> <span class="ow">in</span> <span class="n">contourfs</span><span class="p">:</span>
				<span class="n">contourf</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">pass</span>

		<span class="c1"># Determine date.</span>
		<span class="n">cube_time</span> <span class="o">=</span> <span class="n">cubes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
		<span class="n">date</span> <span class="o">=</span> <span class="n">cube_time</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">cube_time</span><span class="o">.</span><span class="n">points</span><span class="p">)[</span><span class="n">frame</span><span class="p">]</span>

		<span class="c1"># Set colour map.</span>
		<span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s2">&quot;mm&quot;</span><span class="p">:</span>
			<span class="c1"># Precipitation.</span>
			<span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;BrBG&quot;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="c1"># Everything else:</span>
			<span class="n">cmap</span><span class="o">=</span> <span class="s2">&quot;RdBu_r&quot;</span>

		<span class="c1"># Loop through cubes.</span>
		<span class="n">contourfs</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
			<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
				<span class="c1"># Create longitude-latitude meshgrid.</span>
				<span class="n">lon</span> <span class="o">=</span> <span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span>
				<span class="n">lat</span> <span class="o">=</span> <span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span>
				<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>

				<span class="c1"># Check if the grid is rectangular. </span>
				<span class="k">if</span> <span class="n">lon</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
					<span class="c1"># Generate mesh grid.</span>
					<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="c1"># Get longitude-latitude as x-y.</span>
					<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span>

				<span class="c1"># Get axis for plotting.</span>
				<span class="k">if</span> <span class="n">nrows</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
					<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span>
				<span class="k">elif</span> <span class="n">nrows</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
					<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
				<span class="k">elif</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
					<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>

				<span class="c1"># Create inital contour plot.</span>
				<span class="n">contourf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
					<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">frame</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s2">&quot;both&quot;</span>
				<span class="p">)</span>
				<span class="n">contourfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contourf</span><span class="p">)</span>

		<span class="c1"># Add title.</span>
		<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span>
			<span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n</span><span class="s2">Date: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-%m-%Y %H:%M&#39;</span><span class="p">)),</span> 
			<span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span>
		<span class="p">)</span>

		<span class="c1"># Save frame.</span>
		<span class="n">fname</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">.png&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
			<span class="n">folder</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">%H%M&#39;</span><span class="p">)</span>
		<span class="p">)</span>

		<span class="k">if</span> <span class="ow">not</span> <span class="s2">&quot;Reference: ERA5&quot;</span> <span class="ow">in</span> <span class="n">title</span><span class="p">:</span>
			<span class="c1"># Save every frame is gridded dataset.</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">fname</span><span class="p">))</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="c1"># Save every fourth frame if ERA5.</span>
			<span class="k">if</span> <span class="n">frame</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">fname</span><span class="p">))</span>

		<span class="c1"># Update progress bar.</span>
		<span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

		<span class="k">return</span> <span class="n">contourfs</span>

	<span class="c1"># Set size.</span>
	<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

	<span class="c1"># Initialize tqdm progress bar</span>
	<span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span>
		<span class="n">total</span><span class="o">=</span><span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Animating bias plots&quot;</span>
	<span class="p">)</span>

	<span class="c1"># Create animation.</span>
	<span class="n">ani</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span>
		<span class="n">fig</span><span class="p">,</span> 
		<span class="n">update</span><span class="p">,</span> 
		<span class="n">frames</span><span class="o">=</span><span class="n">cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
		<span class="n">fargs</span><span class="o">=</span><span class="p">(</span><span class="n">cubes</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">pbar</span><span class="p">,</span> <span class="n">folder</span><span class="p">),</span>
		<span class="n">interval</span><span class="o">=</span><span class="n">interval</span>
	<span class="p">)</span>

	<span class="c1"># Create colour bar.</span>
	<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
		<span class="n">contourf</span><span class="p">,</span> 
		<span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> 
		<span class="n">aspect</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> 
		<span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span> 
		<span class="n">extend</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> 
		<span class="n">fraction</span><span class="o">=</span><span class="mf">0.02</span>
	<span class="p">)</span>
	<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
	<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

	<span class="c1"># Check if folder exists.</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">folder</span><span class="p">):</span>
		<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>

	<span class="c1"># Save file as MP4.</span>
	<span class="n">fname</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_ani.mp4&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
	<span class="n">ani</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">fname</span><span class="p">))</span>

	<span class="c1"># Close progress bar.</span>
	<span class="n">pbar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

	<span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="master.calculate_crude_track" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">calculate_crude_track</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">calculate_crude_track</span><span class="p">(</span><span class="n">psl_cube</span><span class="p">,</span> <span class="n">time_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Estimate a crude extratropical cyclone track from sea-level pressure data.</p>
<p>For each timestep in the input cube, the location of the minimum sea-level
pressure is identified. The resulting sequence of longitude/latitude
points provides an approximate storm track.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>psl_cube</code>
            </td>
            <td>
                  <code><span title="iris.cube.Cube">Cube</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sea-level pressure cube with dimensions <code>(time, latitude, longitude)</code>.
Must include <code>time</code>, <code>latitude</code>, and <code>longitude</code> coordinates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>time_constraint</code>
            </td>
            <td>
                  <code><span title="iris.Constraint">Constraint</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Constraint to restrict the analysis to a subset of the time dimension.
Default is None (use all available timesteps).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>lon</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>1D array of longitudes (degrees east) at the minimum pressure location
for each timestep.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>lat</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>1D array of latitudes (degrees north) at the minimum pressure location
for each timestep.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>The track is “crude” because only the single grid point of minimum sea-level
  pressure is retained per timestep; no temporal smoothing or tracking
  heuristics are applied.</li>
<li>Uses :func:<code>iris.analysis.MIN</code> to collapse over latitude and longitude.</li>
<li>If multiple points share the same minimum value at a timestep, all are returned,
  which may result in more points than timesteps.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>master.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_crude_track</span><span class="p">(</span><span class="n">psl_cube</span><span class="p">,</span> <span class="n">time_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Estimate a crude extratropical cyclone track from sea-level pressure data.</span>

<span class="sd">    For each timestep in the input cube, the location of the minimum sea-level</span>
<span class="sd">    pressure is identified. The resulting sequence of longitude/latitude</span>
<span class="sd">    points provides an approximate storm track.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    psl_cube : iris.cube.Cube</span>
<span class="sd">        Sea-level pressure cube with dimensions ``(time, latitude, longitude)``.</span>
<span class="sd">        Must include ``time``, ``latitude``, and ``longitude`` coordinates.</span>
<span class="sd">    time_constraint : iris.Constraint, optional</span>
<span class="sd">        Constraint to restrict the analysis to a subset of the time dimension.</span>
<span class="sd">        Default is None (use all available timesteps).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    lon : numpy.ndarray</span>
<span class="sd">        1D array of longitudes (degrees east) at the minimum pressure location</span>
<span class="sd">        for each timestep.</span>
<span class="sd">    lat : numpy.ndarray</span>
<span class="sd">        1D array of latitudes (degrees north) at the minimum pressure location</span>
<span class="sd">        for each timestep.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - The track is “crude” because only the single grid point of minimum sea-level</span>
<span class="sd">      pressure is retained per timestep; no temporal smoothing or tracking</span>
<span class="sd">      heuristics are applied.</span>
<span class="sd">    - Uses :func:`iris.analysis.MIN` to collapse over latitude and longitude.</span>
<span class="sd">    - If multiple points share the same minimum value at a timestep, all are returned,</span>
<span class="sd">      which may result in more points than timesteps.</span>
<span class="sd">    &quot;&quot;&quot;</span>
	<span class="c1"># Extract relevant period.</span>
	<span class="k">if</span> <span class="n">time_constraint</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">psl_cube</span> <span class="o">=</span> <span class="n">psl_cube</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">time_constraint</span><span class="p">)</span>

	<span class="c1"># Calculate minimum pressure values.</span>
	<span class="n">min_psl</span> <span class="o">=</span> <span class="n">psl_cube</span><span class="o">.</span><span class="n">collapsed</span><span class="p">(</span>
		<span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">],</span> <span class="n">iris</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">MIN</span>
	<span class="p">)</span><span class="o">.</span><span class="n">data</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
		<span class="p">(</span><span class="n">psl_cube</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">psl_cube</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">psl_cube</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
	<span class="p">)</span>
	<span class="n">min_psl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">min_psl</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
	<span class="c1"># Get indices.</span>
	<span class="n">min_psl_indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">psl_cube</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="n">min_psl</span><span class="p">)</span>

	<span class="c1"># Get relevant points.</span>
	<span class="n">lon</span> <span class="o">=</span> <span class="n">psl_cube</span><span class="p">[</span><span class="n">min_psl_indx</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;longitude&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span>
	<span class="n">lat</span> <span class="o">=</span> <span class="n">psl_cube</span><span class="p">[</span><span class="n">min_psl_indx</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;latitude&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span>

	<span class="k">return</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="master.plot_extratropical_cyclone_track" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">plot_extratropical_cyclone_track</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot_extratropical_cyclone_track</span><span class="p">(</span><span class="n">cubes</span><span class="p">,</span> <span class="n">focus_t0</span><span class="p">,</span> <span class="n">focus_t1</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Plot extratropical cyclone tracks from one or more simulations.</p>
<p>Each input cube is constrained to a focus period, a crude track
(longitude/latitude sequence) is calculated, and the resulting tracks
are plotted on a Plate Carrée map with coastlines and land shading.
Multiple simulations can be shown together with distinct colors.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cubes</code>
            </td>
            <td>
                  <code>list of iris.cube.Cube</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of pressure (e.g., sea-level pressure) cubes from different
simulations. Each cube must contain time, latitude, and longitude
coordinates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>focus_t0</code>
            </td>
            <td>
                  <code><span title="datetime.datetime">datetime</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Start of the focus period (inclusive).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>focus_t1</code>
            </td>
            <td>
                  <code><span title="datetime.datetime">datetime</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>End of the focus period (inclusive).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Title for the plot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>labels</code>
            </td>
            <td>
                  <code>list of str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labels for each cyclone track, one per input cube.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fname</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path (including filename) where the figure will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>success</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns <code>True</code> after successfully creating and saving the plot.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>Tracks are derived using :func:<code>calculate_crude_track</code>, which should
  return longitude and latitude arrays describing the storm path.</li>
<li>Only the period between <code>focus_t0</code> and <code>focus_t1</code> is plotted.</li>
<li>Land is shaded in beige (<code>#FFE6B3</code>), with coastlines drawn at 10m
  resolution.</li>
<li>Colors cycle through a standard list
  (<code>['b', 'orange', 'g', 'r', 'purple', 'c']</code>).</li>
<li>The output figure size is fixed to <code>(7.5, 4)</code> inches.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>master.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_extratropical_cyclone_track</span><span class="p">(</span><span class="n">cubes</span><span class="p">,</span> <span class="n">focus_t0</span><span class="p">,</span> <span class="n">focus_t1</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">fname</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot extratropical cyclone tracks from one or more simulations.</span>

<span class="sd">    Each input cube is constrained to a focus period, a crude track</span>
<span class="sd">    (longitude/latitude sequence) is calculated, and the resulting tracks</span>
<span class="sd">    are plotted on a Plate Carrée map with coastlines and land shading.</span>
<span class="sd">    Multiple simulations can be shown together with distinct colors.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cubes : list of iris.cube.Cube</span>
<span class="sd">        List of pressure (e.g., sea-level pressure) cubes from different</span>
<span class="sd">        simulations. Each cube must contain time, latitude, and longitude</span>
<span class="sd">        coordinates.</span>
<span class="sd">    focus_t0 : datetime-like</span>
<span class="sd">        Start of the focus period (inclusive).</span>
<span class="sd">    focus_t1 : datetime-like</span>
<span class="sd">        End of the focus period (inclusive).</span>
<span class="sd">    title : str</span>
<span class="sd">        Title for the plot.</span>
<span class="sd">    labels : list of str</span>
<span class="sd">        Labels for each cyclone track, one per input cube.</span>
<span class="sd">    fname : str</span>
<span class="sd">        Path (including filename) where the figure will be saved.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    success : bool</span>
<span class="sd">        Returns ``True`` after successfully creating and saving the plot.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - Tracks are derived using :func:`calculate_crude_track`, which should</span>
<span class="sd">      return longitude and latitude arrays describing the storm path.</span>
<span class="sd">    - Only the period between `focus_t0` and `focus_t1` is plotted.</span>
<span class="sd">    - Land is shaded in beige (``#FFE6B3``), with coastlines drawn at 10m</span>
<span class="sd">      resolution.</span>
<span class="sd">    - Colors cycle through a standard list</span>
<span class="sd">      (``[&#39;b&#39;, &#39;orange&#39;, &#39;g&#39;, &#39;r&#39;, &#39;purple&#39;, &#39;c&#39;]``).</span>
<span class="sd">    - The output figure size is fixed to ``(7.5, 4)`` inches.</span>
<span class="sd">    &quot;&quot;&quot;</span>
	<span class="c1"># Create plot space.</span>
	<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
		<span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()}</span>
	<span class="p">)</span>

	<span class="c1"># Add high-resolution coastlines.</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;10m&#39;</span><span class="p">)</span>

	<span class="c1"># Fill land and ocean.</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;#FFE6B3&#39;</span><span class="p">)</span>

	<span class="c1"># List of standard colors in Matplotlib</span>
	<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>

	<span class="c1"># Focus period.</span>
	<span class="n">focus_period</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span>
		<span class="n">time</span><span class="o">=</span><span class="k">lambda</span> <span class="n">cell</span><span class="p">:</span> <span class="n">focus_t0</span> <span class="o">&lt;=</span> <span class="n">cell</span><span class="o">.</span><span class="n">point</span> <span class="o">&lt;=</span> <span class="n">focus_t1</span>
	<span class="p">)</span>

	<span class="c1"># Loop through simulation tracks.</span>
	<span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cubes</span><span class="p">)):</span>
		<span class="c1"># Calculate storm longitude and latitude.</span>
		<span class="n">cube</span> <span class="o">=</span> <span class="n">cubes</span><span class="p">[</span><span class="n">it</span><span class="p">]</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">focus_period</span><span class="p">)</span>
		<span class="n">storm_eowyn_lon</span><span class="p">,</span> <span class="n">storm_eowyn_lat</span> <span class="o">=</span> <span class="n">calculate_crude_track</span><span class="p">(</span><span class="n">psl_cube</span><span class="o">=</span><span class="n">cube</span><span class="p">)</span>

		<span class="c1"># Plot result.</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">storm_eowyn_lon</span><span class="p">,</span> <span class="n">storm_eowyn_lat</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">labels</span><span class="p">[</span><span class="n">it</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">it</span><span class="p">])</span>

	<span class="c1"># Add legend.</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

	<span class="c1"># Add title.</span>
	<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

	<span class="c1"># Set size.</span>
	<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">7.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

	<span class="c1"># Save.</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

	<span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="master.create_weather_map_ani" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_weather_map_ani</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_weather_map_ani</span><span class="p">(</span><span class="n">pres_cubes</span><span class="p">,</span> <span class="n">pr_cubes</span><span class="p">,</span> <span class="n">focus_period</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">subtitles</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">interval</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create an animated weather map showing precipitation rate and mean sea-level pressure.</p>
<p>For each timestep in the focus period, precipitation rate (shaded contours)
is overlaid with mean sea-level pressure (black contour lines). The function
generates both individual frame images (PNG) and an MP4 animation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pres_cubes</code>
            </td>
            <td>
                  <code>list of list of iris.cube.Cube</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nested list (2D structure) of sea-level pressure cubes. Each cube must
include dimensions <code>(time, latitude, longitude)</code> and a <code>time</code> coordinate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pr_cubes</code>
            </td>
            <td>
                  <code>list of list of iris.cube.Cube</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nested list (2D structure) of precipitation rate cubes, same shape as
<code>pres_cubes</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>focus_period</code>
            </td>
            <td>
                  <code><span title="iris.Constraint">Constraint</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Constraint selecting the time period to animate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Overall title for the animation. The current date is appended automatically
in each frame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subtitles</code>
            </td>
            <td>
                  <code>list of list of str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nested list of subplot titles, same shape as <code>pres_cubes</code> / <code>pr_cubes</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unit</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unit string for the precipitation rate (e.g., <code>"mm/hr"</code>). Used to
label the colorbar.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>folder</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the output folder. Individual frames (PNG) and the MP4 animation
will be saved here. The folder is created if it does not exist.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code>tuple of float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Figure size in inches, e.g., (width, height).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Delay between frames in milliseconds (passed to
:class:<code>matplotlib.animation.FuncAnimation</code>).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>success</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns <code>True</code> after successfully creating and saving the animation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>Precipitation shading uses :func:<code>prate_1hr_cmap</code> for contour levels and colormap.</li>
<li>Sea-level pressure contours are drawn every 5 hPa from 930 to 1040 hPa,
  with inline labels.</li>
<li>If <code>"Reference: ERA5"</code> is present in the title, only every fourth frame
  is saved as PNG; otherwise, all frames are saved.</li>
<li>A horizontal colorbar is added below the subplots, labelled with <code>unit</code>.</li>
<li>Coastlines are drawn with 10m resolution.</li>
<li>Progress is tracked with a :class:<code>tqdm</code> progress bar.</li>
<li>The final MP4 is saved as <code>&lt;folder&gt;/&lt;foldername&gt;_ani.mp4</code> where
  <code>foldername</code> is the basename of <code>folder</code>.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>master.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_weather_map_ani</span><span class="p">(</span><span class="n">pres_cubes</span><span class="p">,</span> <span class="n">pr_cubes</span><span class="p">,</span> <span class="n">focus_period</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">subtitles</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">interval</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create an animated weather map showing precipitation rate and mean sea-level pressure.</span>

<span class="sd">    For each timestep in the focus period, precipitation rate (shaded contours)</span>
<span class="sd">    is overlaid with mean sea-level pressure (black contour lines). The function</span>
<span class="sd">    generates both individual frame images (PNG) and an MP4 animation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pres_cubes : list of list of iris.cube.Cube</span>
<span class="sd">        Nested list (2D structure) of sea-level pressure cubes. Each cube must</span>
<span class="sd">        include dimensions ``(time, latitude, longitude)`` and a ``time`` coordinate.</span>
<span class="sd">    pr_cubes : list of list of iris.cube.Cube</span>
<span class="sd">        Nested list (2D structure) of precipitation rate cubes, same shape as</span>
<span class="sd">        `pres_cubes`.</span>
<span class="sd">    focus_period : iris.Constraint</span>
<span class="sd">        Constraint selecting the time period to animate.</span>
<span class="sd">    title : str</span>
<span class="sd">        Overall title for the animation. The current date is appended automatically</span>
<span class="sd">        in each frame.</span>
<span class="sd">    subtitles : list of list of str</span>
<span class="sd">        Nested list of subplot titles, same shape as `pres_cubes` / `pr_cubes`.</span>
<span class="sd">    unit : str</span>
<span class="sd">        Unit string for the precipitation rate (e.g., ``&quot;mm/hr&quot;``). Used to</span>
<span class="sd">        label the colorbar.</span>
<span class="sd">    folder : str</span>
<span class="sd">        Path to the output folder. Individual frames (PNG) and the MP4 animation</span>
<span class="sd">        will be saved here. The folder is created if it does not exist.</span>
<span class="sd">    size : tuple of float</span>
<span class="sd">        Figure size in inches, e.g., (width, height).</span>
<span class="sd">    interval : int</span>
<span class="sd">        Delay between frames in milliseconds (passed to</span>
<span class="sd">        :class:`matplotlib.animation.FuncAnimation`).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    success : bool</span>
<span class="sd">        Returns ``True`` after successfully creating and saving the animation.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - Precipitation shading uses :func:`prate_1hr_cmap` for contour levels and colormap.</span>
<span class="sd">    - Sea-level pressure contours are drawn every 5 hPa from 930 to 1040 hPa,</span>
<span class="sd">      with inline labels.</span>
<span class="sd">    - If ``&quot;Reference: ERA5&quot;`` is present in the title, only every fourth frame</span>
<span class="sd">      is saved as PNG; otherwise, all frames are saved.</span>
<span class="sd">    - A horizontal colorbar is added below the subplots, labelled with `unit`.</span>
<span class="sd">    - Coastlines are drawn with 10m resolution.</span>
<span class="sd">    - Progress is tracked with a :class:`tqdm` progress bar.</span>
<span class="sd">    - The final MP4 is saved as ``&lt;folder&gt;/&lt;foldername&gt;_ani.mp4`` where</span>
<span class="sd">      ``foldername`` is the basename of `folder`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
	<span class="c1"># Determine number of rows.</span>
	<span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pres_cubes</span><span class="p">)</span>
	<span class="n">ncols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pres_cubes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

	<span class="c1"># Create plot space.</span>
	<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
		<span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()}</span>
	<span class="p">)</span>

	<span class="c1"># Retrieve rainfall levels and create normalisation.</span>
	<span class="c1"># Retrieve colour map.</span>
	<span class="n">cmap</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">prate_1hr_cmap</span><span class="p">()</span>
	<span class="c1"># Create norm.</span>
	<span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
	<span class="c1"># Add to list.</span>
	<span class="n">cmapping</span> <span class="o">=</span> <span class="p">[</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="p">]</span>

	<span class="c1"># Loop through datasets.</span>
	<span class="n">contourfs</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="n">new_pres_cubes</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="n">new_pr_cubes</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
		<span class="n">pres_cubes_row</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">pr_cubes_row</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
			<span class="c1"># Create longitude-latitude meshgrid.</span>
			<span class="n">lon</span> <span class="o">=</span> <span class="n">pr_cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span>
			<span class="n">lat</span> <span class="o">=</span> <span class="n">pr_cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span>
			<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>

			<span class="c1"># Check if the grid is rectangular. </span>
			<span class="k">if</span> <span class="n">lon</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="c1"># Generate mesh grid.</span>
				<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="c1"># Get longitude-latitude as x-y.</span>
				<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span>

			<span class="c1"># Get axis for plotting.</span>
			<span class="k">if</span> <span class="n">nrows</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span>
			<span class="k">elif</span> <span class="n">nrows</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
			<span class="k">elif</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>

			<span class="c1"># Add high-resolution coastlines.</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;10m&#39;</span><span class="p">)</span>

			<span class="c1"># Add subplot title.</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">subtitles</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>

			<span class="c1"># Extract time period.</span>
			<span class="c1"># Pressure.</span>
			<span class="n">pres_cube</span> <span class="o">=</span> <span class="n">pres_cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">focus_period</span><span class="p">)</span>
			<span class="n">pres_cubes_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pres_cube</span><span class="p">)</span>
			<span class="c1"># Rainfall.</span>
			<span class="n">pr_cube</span> <span class="o">=</span> <span class="n">pr_cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">focus_period</span><span class="p">)</span>
			<span class="n">pr_cubes_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pr_cube</span><span class="p">)</span>

			<span class="c1"># Precipitation rate.</span>
			<span class="n">contourf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
				<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">pr_cube</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> 
				<span class="n">levels</span><span class="o">=</span><span class="n">cmapping</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmapping</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">norm</span><span class="o">=</span><span class="n">cmapping</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> 
				<span class="n">extend</span><span class="o">=</span><span class="s2">&quot;max&quot;</span>
			<span class="p">)</span>
			<span class="n">contourfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contourf</span><span class="p">)</span>

		<span class="c1"># Add row of time constrained cubes.</span>
		<span class="n">new_pres_cubes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pres_cubes_row</span><span class="p">)</span>
		<span class="n">new_pr_cubes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pr_cubes_row</span><span class="p">)</span>

	<span class="c1"># Redefine cubes variable.</span>
	<span class="n">pres_cubes</span> <span class="o">=</span> <span class="n">new_pres_cubes</span>
	<span class="n">pr_cubes</span> <span class="o">=</span> <span class="n">new_pr_cubes</span>

	<span class="c1"># Update function for animation.</span>
	<span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">pres_cubes</span><span class="p">,</span> <span class="n">pr_cubes</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">pbar</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">cmapping</span><span class="p">):</span>
		<span class="c1"># Determine number of rows.</span>
		<span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pr_cubes</span><span class="p">)</span>
		<span class="n">ncols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pr_cubes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

		<span class="c1"># Remove plots.</span>
		<span class="c1"># Define global.</span>
		<span class="k">global</span> <span class="n">contours</span>
		<span class="k">global</span> <span class="n">contourfs</span>
		<span class="c1"># Try removal.</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">contourf</span> <span class="ow">in</span> <span class="n">contourfs</span><span class="p">:</span>
				<span class="n">contourf</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
			<span class="k">for</span> <span class="n">contour</span> <span class="ow">in</span> <span class="n">contours</span><span class="p">:</span>
				<span class="n">contour</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">pass</span>

		<span class="c1"># Determine date.</span>
		<span class="n">cube_time</span> <span class="o">=</span> <span class="n">pr_cubes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
		<span class="n">date</span> <span class="o">=</span> <span class="n">cube_time</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">cube_time</span><span class="o">.</span><span class="n">points</span><span class="p">)[</span><span class="n">frame</span><span class="p">]</span>

		<span class="c1"># Loop through cubes.</span>
		<span class="n">contours</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">contourfs</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
			<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
				<span class="c1"># Create longitude-latitude meshgrid.</span>
				<span class="n">lon</span> <span class="o">=</span> <span class="n">pr_cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span>
				<span class="n">lat</span> <span class="o">=</span> <span class="n">pr_cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span>

				<span class="c1"># Check if the grid is rectangular. </span>
				<span class="k">if</span> <span class="n">lon</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
					<span class="c1"># Generate mesh grid.</span>
					<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="c1"># Get longitude-latitude as x-y.</span>
					<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span>

				<span class="c1"># Get relevant cube.</span>
				<span class="n">pres_cube_data</span> <span class="o">=</span> <span class="n">pres_cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">frame</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
				<span class="n">pr_cube_data</span> <span class="o">=</span> <span class="n">pr_cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">frame</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

				<span class="c1"># Get axis for plotting.</span>
				<span class="k">if</span> <span class="n">nrows</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
					<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span>
				<span class="k">elif</span> <span class="n">nrows</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
					<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
				<span class="k">elif</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
					<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>

				<span class="c1"># Precipitation rate.</span>
				<span class="n">contourf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
					<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">pr_cube_data</span><span class="p">,</span> 
					<span class="n">levels</span><span class="o">=</span><span class="n">cmapping</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmapping</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">norm</span><span class="o">=</span><span class="n">cmapping</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> 
					<span class="n">extend</span><span class="o">=</span><span class="s2">&quot;max&quot;</span>
				<span class="p">)</span>

				<span class="c1"># Mean sea level pressure.</span>
				<span class="n">pres_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">930</span><span class="p">,</span> <span class="mi">1040</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
				<span class="n">contour</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span>
					<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">pres_cube_data</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">pres_levels</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span>
				<span class="p">)</span>

				<span class="c1"># Add labels.</span>
				<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

				<span class="c1"># Append to list.</span>
				<span class="n">contours</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contour</span><span class="p">)</span>

				<span class="c1"># Append contourf.	</span>
				<span class="n">contourfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contourf</span><span class="p">)</span>

		<span class="c1"># Add title.</span>
		<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span>
			<span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n</span><span class="s2">Date: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-%m-%Y %H:%M&#39;</span><span class="p">)),</span> 
			<span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span>
		<span class="p">)</span>

		<span class="c1"># Save frame.</span>
		<span class="n">fname</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">.png&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
			<span class="n">folder</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">%H%M&#39;</span><span class="p">)</span>
		<span class="p">)</span>

		<span class="k">if</span> <span class="ow">not</span> <span class="s2">&quot;Reference: ERA5&quot;</span> <span class="ow">in</span> <span class="n">title</span><span class="p">:</span>
			<span class="c1"># Save every frame is gridded dataset.</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">fname</span><span class="p">))</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="c1"># Save every fourth frame if ERA5.</span>
			<span class="k">if</span> <span class="n">frame</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">fname</span><span class="p">))</span>

		<span class="c1"># Update progress bar.</span>
		<span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

		<span class="k">return</span> <span class="n">contourfs</span>

	<span class="c1"># Initialize tqdm progress bar</span>
	<span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span>
		<span class="n">total</span><span class="o">=</span><span class="n">pr_cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Animating parameter plots&quot;</span>
	<span class="p">)</span>

	<span class="c1"># Create animation.</span>
	<span class="n">ani</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span>
		<span class="n">fig</span><span class="p">,</span> 
		<span class="n">update</span><span class="p">,</span> 
		<span class="n">frames</span><span class="o">=</span><span class="n">pr_cubes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
		<span class="n">fargs</span><span class="o">=</span><span class="p">(</span><span class="n">pres_cubes</span><span class="p">,</span> <span class="n">pr_cubes</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">pbar</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">cmapping</span><span class="p">),</span>
		<span class="n">interval</span><span class="o">=</span><span class="n">interval</span>
	<span class="p">)</span>

	<span class="c1"># Create colour bar.</span>
	<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
		<span class="n">contourf</span><span class="p">,</span> 
		<span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> 
		<span class="n">aspect</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> 
		<span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span> 
		<span class="n">extend</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> 
		<span class="n">fraction</span><span class="o">=</span><span class="mf">0.02</span>
	<span class="p">)</span>
	<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
	<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

	<span class="c1"># Set size.</span>
	<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

	<span class="c1"># Check if folder exists.</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">folder</span><span class="p">):</span>
		<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>

	<span class="c1"># Save file as MP4.</span>
	<span class="n">fname</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_ani.mp4&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
	<span class="n">ani</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">fname</span><span class="p">))</span>

	<span class="c1"># Close progress bar.</span>
	<span class="n">pbar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

	<span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>